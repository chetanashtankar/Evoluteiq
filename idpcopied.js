/* Add your JS code Here */

debugger;
let pdfDoc = null;
let totalPagesDisplay = 0;
let scale = 1;
let fileName = "Visible Emission Cert";
let pdfBase64 = "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2yU1HUTMFOwF0cRcAbnS4CqXkbFP1ZWfMO+xfQyJRHzz5GxT9WVnzDvsTyLin6srPmHfYvoZEoPnnyNin6srPmHfYnkXFP1ZWfMO+xfQyJQfPPkbFP1ZWfMO+xPI2Kfqys+Yd9i+hkSg+efI2Kfqys+Yd9ieRcU/VlZ8w77F9DIlB88+RsV/VlZ8w77E8i4p+rKz5h32L6GRKD558jYp+rKz5h32J5FxT9WVnzDvsX0MiUHzz5FxT9WVnzDvsTyLin6srPmHfYvoZEoPnnyLin6srPmHfYnkXFP1ZWfMO+xfQyJQfPPkbFP1ZWfMO+xPIuKfqys+Yd9i+hkSg+efI2K/qys+Yd9ieRcU/VlZ8w77F9DIlB88+RsV/VlZ8w77E8jYp+rKz5h32L6GRKD558jYp+rKz5h32J5GxX9WVnzDvsX0MiUHzz5FxT9WVnzDvsTyNiv6srPmHfYvoZEoPnnyLin6srPmHfYnkbFP1ZWfMO+xfQyJQfPPkXFP1ZWfMO+xPIuKfqys+Yd9i+hkSg+efIuKfqys+Yd9ieRsU/VlZ8w77F9DIlB88+RcU/VlZ8w77E8jYr+rKz5h32L6GRKD558i4p+rKz5h32J5GxX9WVnzDvsX0MiUHzz5FxT9WVnzDvsTyNin6srPmHfYvoZEoPnnyNin6srPmHfYnkbFP1ZWfMO+xfQyJQfPPkXFP1ZWfMO+xPI2Kfqys+Yd9i+hkSg+efIuKfqys+Yd9ieRsU/VlZ8w77F9DIlB88+RcU/VlZ8w77FfvBhRVVHVYl4zTTQZmMy9LGW3sTe116QiUH//2Q0KZW5kc3RyZWFtDQplbmRvYmoNCjQgMCBvYmoNCjw8DQovRmlsdGVyIC9GbGF0ZURlY29kZQ0KL0xlbmd0aCA0Ng0KPj4NCnN0cmVhbQ0KeJwr5DI1M1UwAEJzS2M9AzMFQ1MFIxM9E3MDQ4XkXC79CAMFl3yuQC4AoFAIAg0KZW5kc3RyZWFtDQplbmRvYmoNCjIgMCBvYmoNCjw8DQovVHlwZSAvUGFnZXMNCi9LaWRzIFsgMSAwIFIgXQ0KL0NvdW50IDENCj4+DQplbmRvYmoNCjUgMCBvYmoNCjw8DQovVHlwZSAvQ2F0YWxvZw0KL1BhZ2VzIDIgMCBSDQo+Pg0KZW5kb2JqDQp4cmVmDQowIDYNCjAwMDAwMDAwMDAgNjU1MzUgZg0KMDAwMDAwMDAxNyAwMDAwMCBuDQowMDAwMDI4NjYwIDAwMDAwIG4NCjAwMDAwMDAxNzAgMDAwMDAgbg0KMDAwMDAyODUzNCAwMDAwMCBuDQowMDAwMDI4NzI2IDAwMDAwIG4NCnRyYWlsZXINCjw8DQovU2l6ZSA2DQovUm9vdCA1IDAgUg0KL0lEIFs8OTk5YWMzODViYWI4ZGQ3YzkzOGIxNWQxMGI0NzgwY2Y+PDk5OWFjMzg1YmFiOGRkN2M5MzhiMTVkMTBiNDc4MGNmPl0NCj4+DQpzdGFydHhyZWYNCjI4NzgxDQolJUVPRg0K"
const pdfContainer = document.createElement('div');
pdfContainer.id = 'pdf-container';

try {
    loadPdf(pdfBase64, pdfContainer);
}
catch (error) {
    console.log("Error in loading pdfs" + error);
}
try {
    createPDFViewer(pdfContainer, fileName);
}
catch (error) {
    console.log("Error in creating pdf tool bars" + error);
}

try {
    createSVGContainer();
}
catch (error) {
    console.log("Error Creating SVG Container")
}
try {
    resizeBar();
}
catch (error) {
    console.log("Error in creating Resize bars" + error);
}
function resizeBar() {
    const container = document.getElementById('platform_id_4mszTiuY');

    // Check if the container exists
    if (container) {
        // Assuming the two columns are direct children of the container:
        const columns = container.children;

        // Ensure there are at least two columns
        if (columns.length >= 2) {
            // Select the second column (the one that comes after the first column)
            const secondColumn = columns[1];

            // Create the new div element
            const resizeBar = document.createElement('div');

            // Add the 'resize-bar' class to it
            resizeBar.className = 'resize-bar';

            // Insert the new div between the two columns by placing it before the second column
            container.insertBefore(resizeBar, secondColumn);
        }
    }

    /*resize button icon add code*/
    const buttonContent = document.createElement('button');
    buttonContent.classList.add('icon-button');
    const icon = document.createElement('i');
    icon.classList.add('fa', 'fa-bars');
    buttonContent.appendChild(icon);
    const resizeBarContent = document.querySelector('.resize-bar');
    resizeBarContent.append(buttonContent);

    resizeBar = document.querySelector('.resize-bar button');
    leftContainer = document.querySelector('#platform_id_4mszTiuY-2');
    rightContainer = document.querySelector('#platform_id_4mszTiuY-3');

    resizeBar.addEventListener('mousedown', (e) => {
        debugger;
        const startX = e.clientX;
        const startWidth = leftContainer.offsetWidth;
        const rightWidth = rightContainer.offsetWidth;

        const onMouseMove = (e) => {
            const leftNewWidth = startWidth + (e.clientX - startX);
            leftContainer.style.width = `${leftNewWidth}px`;
            const tabContents = document.querySelectorAll('#tab-container .tab-content');
            tabContents.forEach(function (divContent) {
                divContent.style.width = `${leftNewWidth - 20}px`;
            });
            const rightNewWidth = rightWidth + (startX - e.clientX);
            rightContainer.style.width = `${rightNewWidth}px`;
        };

        const onMouseUp = () => {
            document.removeEventListener('mousemove', onMouseMove);
            document.removeEventListener('mouseup', onMouseUp);
        };

        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('mouseup', onMouseUp);
    });
}

function loadPdf(base64Data, pdfContainer) {
    const pdfData = atob(base64Data);
    const typedArray = new Uint8Array(pdfData.length);
    for (let i = 0; i < pdfData.length; i++) {
        typedArray[i] = pdfData.charCodeAt(i);
    }
    delete Array.prototype._indexOf;

    pdfjsLib.getDocument({ data: typedArray }).promise
        .then(function (pdfDoc_) {
            pdfDoc = pdfDoc_;
            totalPagesDisplay.textContent = pdfDoc.numPages;
            renderAllPages(pdfContainer);


            setTimeout(selectAndHighlight, 2000);
        })
        .catch(function (error) {
            console.error('Error loading PDF:', error);
        });
}

function renderAllPages(pdfContainer) {
    const totalPages = pdfDoc.numPages;
    for (let pageNum = 1; pageNum <= totalPages; pageNum++) {
        renderPage(pageNum, pdfContainer);
    }
}
function renderPage(num, pdfContainer) {
    debugger;
    pdfDoc.getPage(num).then(function (page) {
        let viewport = page.getViewport({ scale: scale });

        // Create the main canvas for PDF content
        const mainCanvas = document.createElement('canvas');
        mainCanvas.className = 'pdf-page';
        mainCanvas.dataset.page = num;
        mainCanvas.width = viewport.width;
        mainCanvas.height = viewport.height;

        // Create the highlight canvas
        const highlightCanvas = document.createElement('canvas');
        highlightCanvas.className = 'highlight-canvas';
        highlightCanvas.dataset.page = num;
        highlightCanvas.width = viewport.width;
        highlightCanvas.height = viewport.height;


        pdfContainer.appendChild(mainCanvas);
        pdfContainer.appendChild(highlightCanvas);

        // Render the PDF content on the main canvas
        let renderContext = {
            canvasContext: mainCanvas.getContext('2d'),
            viewport: viewport
        };
        page.render(renderContext);
    });

}
function createPDFViewer(pdfContainer, fileName) {
    const pdfViewerWrapper = document.querySelector('#platform_id_dsdnHnrF');
    // Create PDF toolbar
    const pdfToolbar = document.createElement('div');
    pdfToolbar.id = 'pdf-toolbar';

    const documentInfo = document.createElement('div');
    documentInfo.id = 'document-info';
    const documentName = document.createElement('span');
    documentName.id = 'document-name';
    documentName.innerText = fileName;
    documentInfo.appendChild(documentName);
    const pageControls = document.createElement('div');
    pageControls.id = 'page-controls';

    const prevPageBtn = document.createElement('button');
    prevPageBtn.id = 'prev-page';
    prevPageBtn.innerText = '<';
    pageControls.appendChild(prevPageBtn);

    const pageInputControl = document.createElement('input');
    pageInputControl.type = 'number';
    pageInputControl.id = 'page-input';
    pageInputControl.value = '1';
    pageInputControl.min = '1';
    pageControls.appendChild(pageInputControl);

    const pageSpan = document.createElement('span');
    pageSpan.innerHTML = '/ <span id="total-pages">10</span>';
    pageControls.appendChild(pageSpan);

    const nextPageBtn = document.createElement('button');
    nextPageBtn.id = 'next-page';
    nextPageBtn.innerText = '>';
    pageControls.appendChild(nextPageBtn);
    const zoomControls = document.createElement('div');
    zoomControls.className = 'zoom-controls';

    const zoomOutBtn = document.createElement('button');
    zoomOutBtn.id = 'zoom-out';
    zoomOutBtn.innerText = '-';
    zoomControls.appendChild(zoomOutBtn);

    const zoomInputContainer = document.createElement('div'); // Create a container for input and %
    //   zoomInputContainer.style.display = 'inline-flex'; // To keep them in a line

    const zoomInputControl = document.createElement('input');
    zoomInputControl.type = 'text';
    zoomInputControl.id = 'zoom-input';
    zoomInputControl.min = '50';
    zoomInputControl.max = '200';
    zoomInputControl.value = '100';


    zoomInputContainer.appendChild(zoomInputControl);
    zoomControls.appendChild(zoomInputContainer);

    const zoomInBtn = document.createElement('button');
    zoomInBtn.id = 'zoom-in';
    zoomInBtn.innerText = '+';
    zoomControls.appendChild(zoomInBtn);

    const extraControls = document.createElement('div');
    extraControls.id = 'extra-controls';


    const downloadBtn = document.createElement('button');
    downloadBtn.id = 'download-pdf';
    downloadBtn.innerHTML = '<i class="fa-solid fa fa-download"></i>';
    extraControls.appendChild(downloadBtn);

    const newWindowPopUpBtn = document.createElement('button');
    newWindowPopUpBtn.id = 'newWindow-pdf';
    newWindowPopUpBtn.innerHTML = '<i class="fa-solid fa fa-external-link"></i>';
    extraControls.appendChild(newWindowPopUpBtn);

    // Append all controls to the toolbar
    pdfToolbar.appendChild(documentInfo);
    pdfToolbar.appendChild(pageControls);
    pdfToolbar.appendChild(zoomControls);
    pdfToolbar.appendChild(extraControls);

    // Create PDF container


    // Append toolbar and container to the wrapper
    //pdfViewerWrapper.appendChild(documentInfo);
    pdfViewerWrapper.appendChild(pdfToolbar);
    pdfViewerWrapper.appendChild(pdfContainer);


    prevPageButton = document.getElementById('prev-page');
    nextPageButton = document.getElementById('next-page');
    pageInput = document.getElementById('page-input');
    totalPagesDisplay = document.getElementById('total-pages');
    zoomOutButton = document.getElementById('zoom-out');
    zoomInButton = document.getElementById('zoom-in');
    zoomInput = document.getElementById('zoom-input');
    downloadButton = document.getElementById('download-pdf');

    prevPageButton.addEventListener('click', () => goToPage(currentPage - 1));
    nextPageButton.addEventListener('click', () => goToPage(currentPage + 1));
    zoomOutButton.addEventListener('click', () => zoomPDF(-0.1));
    zoomInButton.addEventListener('click', () => zoomPDF(0.1));
    zoomOutButton.addEventListener('click', () => zoomPDF(-0.1));
    zoomInButton.addEventListener('click', () => zoomPDF(0.1));
    zoomInput.addEventListener('change', handleZoomInput);
    downloadButton.addEventListener('click', downloadPDF);
}
/* Function called from CreatePDFViewer*/
function zoomPDF(amount) {
    scale += amount;
    scale = Math.max(0.5, Math.min(scale, 2.0)); // Keep zoom between 50% and 200%
    zoomInput.value = Math.round(scale * 100);
    zoomInOut();
    reRenderPDF();  // Re-render the PDF after zoom adjustment
}
/* Function called from CreatePDFViewer*/
function handleZoomInput() {
    const zoomValue = parseInt(zoomInput.value, 10);
    // Check if the value is less than 50 or greater than 200
    if (zoomValue < 50) {
        zoomInput.value = 50; // Set to minimum value
        scale = 0.5; // Update the scale to match the new zoom
    } else if (zoomValue > 200) {
        zoomInput.value = 200; // Set to maximum value
        scale = 2.0; // Update the scale to match the new zoom
    } else if (isNaN(zoomValue)) {
        zoomInput.value = 100;
        scale = 1.0;
    }
    else {
        scale = zoomValue / 100; // Set scale based on the input value
    }
    zoomInOut();
    reRenderPDF();
}
/* Function called from CreatePDFViewer*/
function downloadPDF() {
    debugger;
    const byteCharacters = atob(window.pdfBase64);
    const byteNumbers = new Array(byteCharacters.length);
    for (let i = 0; i < byteCharacters.length; i++) {
        byteNumbers[i] = byteCharacters.charCodeAt(i);
    }
    const byteArray = new Uint8Array(byteNumbers);
    const blob = new Blob([byteArray], { type: 'application/pdf' });

    // Create a link element
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = window.fileName;

    // Append the link to the body
    document.body.appendChild(link);

    // Programmatically click the link to trigger the download
    link.click();

    // Clean up and remove the link
    document.body.removeChild(link);
}
/* Function called from HandleZoomInput*/
function zoomInOut() {
    // Apply the zoom by scaling each canvas element
    const canvases = document.querySelectorAll('#pdf-container canvas');

    canvases.forEach(canvas => {
        canvas.style.transform = `scale(${scale})`;      // Apply scale to canvas
        canvas.style.transformOrigin = '0 0';

        if (scale >= 1) {
            canvas.style.marginBottom = `${(0.05 * (scale * scale * 10000)) - (3 * scale * 100) - 175}px`; // Scale from top-left corner
        } else {
            canvas.style.marginBottom = `${(8.9 * scale * 100) - 887}px`; // Scale from top-left corner
        }
    });
}
/* Function called from HandleZoomInput*/
function reRenderPDF() {
    const canvases = document.querySelectorAll('#pdf-container canvas');
    canvases.forEach((canvas, index) => {
        const pageNum = index + 1; // Page numbers are 1-based
        pdfDoc.getPage(pageNum).then(page => {
            const ctx = canvas.getContext('2d');
            const viewport = page.getViewport({ scale: scale });
            canvas.width = viewport.width; // Update canvas width
            canvas.height = viewport.height; // Update canvas height
            page.render({ canvasContext: ctx, viewport: viewport });
        });
    });
}
/*Function for Highligting (Event Listener)*/
function handleMouseOver(event) {

    const pageNumber = event.target.dataset.page;
    const coordsInput = event.target.dataset.coords;
    const coords = parseCoordinates(coordsInput); // This will give you an array of 8 coordinates

    if (coords && pageNumber) {
        const pageNum = parseInt(pageNumber, 10);
        if (pageNum > 0 && pageNum <= pdfDoc.numPages) {
            pdfDoc.getPage(pageNum).then(page => {
                // Correct query selector with backticks for template literal
                const canvas = document.querySelector(`canvas[data-page="${pageNum}"]`);
                const ctx = canvas.getContext('2d');
                const viewport = page.getViewport({ scale: scale }); // Ensure scale is defined

                // Draw highlight with normalized coordinates
                drawHighlight(viewport, ctx, coords);
                highlightScrollToPage(pageNum, coords[0], coords[1]);
            });
        }
    }
}
/*Function for Highligting (Event Listener)*/
function handleMouseOut(event) {
    const pageNumber = event.target.dataset.page;
    if (pageNumber) {
        const pageNum = parseInt(pageNumber, 10);
        if (pageNum > 0 && pageNum <= pdfDoc.numPages) {
            pdfDoc.getPage(pageNum).then(page => {
                const canvas = document.querySelector(`canvas[data-page="${pageNum}"]`);
                const ctx = canvas.getContext('2d');

                // Get current scroll position and adjust the rendering accordingly
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;

                // Clear the entire canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Get the viewport with the current zoom level
                const viewport = page.getViewport({ scale: scale });

                // Adjust canvas size based on zoom level (scale) and viewport dimensions
                canvas.width = viewport.width;
                canvas.height = viewport.height;

                // Re-render the page with the adjusted viewport, respecting the scroll position
                page.render({
                    canvasContext: ctx,
                    viewport: viewport,
                    transform: [1, 0, 0, 1, -scrollLeft, -scrollTop]
                });
            });
        }
    }
}
/*Called from handleMouseOer*/
function parseCoordinates(coordsInput) {
    // Parse the input string into an array of numbers
    const coords = coordsInput.split(',').map(Number);

    // Ensure there are exactly 8 values
    if (coords.length === 8) {
        return coords; // Return as an array of 8 coordinates
    }
    return null; // In case the coordinates are malformed
}
/*Called from handleMouseOer*/
function drawHighlight(viewport, ctx, coords) {
    // coords will be an array of 8 values: [x1, y1, x2, y2, x3, y3, x4, y4]
    const points = [
        { x: coords[0], y: coords[1] },
        { x: coords[2], y: coords[3] },
        { x: coords[4], y: coords[5] },
        { x: coords[6], y: coords[7] }
    ];

    // Convert the points to the correct scale/viewport space
    points.forEach(point => {
        point.x = point.x * 72;
        point.y = point.y * 72;
    });

    // Draw the polygon on the canvas
    ctx.beginPath();
    ctx.moveTo(points[0].x, points[0].y);

    // Draw lines to the other points
    points.forEach((point, index) => {
        if (index > 0) {
            ctx.lineTo(point.x, point.y);
        }
    });

    // Close the path (complete the polygon)
    ctx.closePath();

    // Apply styling for the highlight (e.g., semi-transparent fill)
    ctx.fillStyle = 'rgba(255, 0, 0, 0.3)'; // Red with transparency
    ctx.fill();
    ctx.lineWidth = 2;
    ctx.strokeStyle = 'red';
    ctx.stroke();
}
/*Called from handleMouseOer*/
function highlightScrollToPage(pageNumber, targetX = 0, targetY = 0) {
    const pageCanvas = document.querySelector(`canvas[data-page="${pageNumber}"]`);
    const container = document.querySelector('#pdf-container');

    if (pageCanvas) {
        // Extract scale from canvas transform property
        const transform = pageCanvas.style.transform;
        const match = transform.match(/scale\(([^)]+)\)/);
        const scale = match ? parseFloat(match[1]) : 1; // Default to 1 if not found

        // Adjust target coordinates according to the zoom (scale)
        const scrollToX = pageCanvas.offsetLeft + (targetX * scale);
        const scrollToY = pageCanvas.offsetTop + (targetY * scale);

        // Scroll the container to the calculated position, with smooth scroll
        container.scrollTo({
            top: scrollToY,
            left: scrollToX,
            behavior: 'smooth'
        });
    }
}
function handlePageInput() {
    let enteredPage = parseInt(pageInput.value, 10);

    if (enteredPage < 1 || isNaN(enteredPage)) {
        pageInput.value = 1;
        enteredPage = 1;
    } else if (enteredPage > pdfDoc.numPages) {
        pageInput.value = pdfDoc.numPages;
        enteredPage = pdfDoc.numPages;
    }

    goToPage(enteredPage);
}
function goToPage(pageNumber) {
    if (pageNumber < 1 || pageNumber > pdfDoc.numPages) return;
    scrollToPage(pageNumber);
}
function scrollToPage(pageNumber) {
    const pageCanvas = document.querySelector(`canvas[data-page="${pageNumber}"]`);
    if (pageCanvas) {
        currentPage = pageNumber;
        pageInput.value = currentPage;
        //const canvasContainer = document.getElementById('canvasContainer'); // Assuming a container ID
        canvasContainer.scrollTop = pageCanvas.offsetTop;
    }
}



let ocrExtractedJSON = {
    "status": "succeeded",
    "createdDateTime": "2025-02-07T06:16:22Z",
    "lastUpdatedDateTime": "2025-02-07T06:16:23Z",
    "analyzeResult": {
        "apiVersion": "2024-11-30",
        "modelId": "prebuilt-layout",
        "stringIndexType": "utf16CodeUnit",
        "content": "O\nVisible Emissions Evaluator Field Certification\nrecipient.name\nThis certificate ottests to the authenticity of the luxury jewelry piece described below and confirms that it is an original design crafted by the specified jeweler.\nEmployee ID: VE234567\nCertification Date: 2022-09-10\nEmployee Name: Jessica Taylor\nExpiration Date: 2024-09-10\nGasparout\nSAMANTHA WRIGHT Authentication Specialist\n[certificate.issued_on] certificato Luid :unselected: :unselected: :unselected: :selected:",
        "pages": [
            {
                "pageNumber": 1,
                "angle": -0.02449999935925007,
                "width": 8.2639,
                "height": 11.6944,
                "unit": "inch",
                "words": [
                    {
                        "content": "O",
                        "polygon": [
                            3.762,
                            0.9853,
                            4.4946,
                            1.0127,
                            4.4946,
                            1.6788,
                            3.7634,
                            1.6788
                        ],
                        "confidence": 0.275,
                        "span": {
                            "offset": 0,
                            "length": 1
                        }
                    },
                    {
                        "content": "Visible",
                        "polygon": [
                            0.619,
                            2.1374,
                            2.3517,
                            2.1414,
                            2.3521,
                            2.6857,
                            0.6196,
                            2.6776
                        ],
                        "confidence": 0.994,
                        "span": {
                            "offset": 2,
                            "length": 7
                        }
                    },
                    {
                        "content": "Emissions",
                        "polygon": [
                            2.5412,
                            2.1427,
                            4.996,
                            2.1454,
                            4.9971,
                            2.6973,
                            2.5418,
                            2.6902
                        ],
                        "confidence": 0.993,
                        "span": {
                            "offset": 10,
                            "length": 9
                        }
                    },
                    {
                        "content": "Evaluator",
                        "polygon": [
                            5.1945,
                            2.1454,
                            7.6357,
                            2.147,
                            7.6357,
                            2.7009,
                            5.1956,
                            2.6993
                        ],
                        "confidence": 0.993,
                        "span": {
                            "offset": 20,
                            "length": 9
                        }
                    },
                    {
                        "content": "Field",
                        "polygon": [
                            1.7494,
                            3.1167,
                            3.0503,
                            3.1107,
                            3.0523,
                            3.67,
                            1.7505,
                            3.6598
                        ],
                        "confidence": 0.997,
                        "span": {
                            "offset": 30,
                            "length": 5
                        }
                    },
                    {
                        "content": "Certification",
                        "polygon": [
                            3.2152,
                            3.1108,
                            6.482,
                            3.1168,
                            6.482,
                            3.6664,
                            3.2166,
                            3.671
                        ],
                        "confidence": 0.991,
                        "span": {
                            "offset": 36,
                            "length": 13
                        }
                    },
                    {
                        "content": "recipient.name",
                        "polygon": [
                            2.3249,
                            4.0092,
                            5.9566,
                            4.0053,
                            5.9566,
                            4.515,
                            2.3256,
                            4.5494
                        ],
                        "confidence": 0.988,
                        "span": {
                            "offset": 50,
                            "length": 14
                        }
                    },
                    {
                        "content": "This",
                        "polygon": [
                            1.1085,
                            5.0901,
                            1.5127,
                            5.0931,
                            1.5124,
                            5.3263,
                            1.1083,
                            5.3248
                        ],
                        "confidence": 0.989,
                        "span": {
                            "offset": 65,
                            "length": 4
                        }
                    },
                    {
                        "content": "certificate",
                        "polygon": [
                            1.5749,
                            5.0933,
                            2.535,
                            5.0923,
                            2.5347,
                            5.3289,
                            1.5746,
                            5.3265
                        ],
                        "confidence": 0.484,
                        "span": {
                            "offset": 70,
                            "length": 11
                        }
                    },
                    {
                        "content": "ottests",
                        "polygon": [
                            2.5972,
                            5.0925,
                            3.2541,
                            5.0947,
                            3.2539,
                            5.3306,
                            2.5969,
                            5.329
                        ],
                        "confidence": 0.975,
                        "span": {
                            "offset": 82,
                            "length": 7
                        }
                    },
                    {
                        "content": "to",
                        "polygon": [
                            3.3085,
                            5.0947,
                            3.495,
                            5.0944,
                            3.4949,
                            5.331,
                            3.3083,
                            5.3307
                        ],
                        "confidence": 0.997,
                        "span": {
                            "offset": 90,
                            "length": 2
                        }
                    },
                    {
                        "content": "the",
                        "polygon": [
                            3.5533,
                            5.0943,
                            3.8643,
                            5.0944,
                            3.8641,
                            5.3322,
                            3.5532,
                            5.3311
                        ],
                        "confidence": 0.992,
                        "span": {
                            "offset": 93,
                            "length": 3
                        }
                    },
                    {
                        "content": "authenticity",
                        "polygon": [
                            3.9265,
                            5.0945,
                            5.0576,
                            5.0964,
                            5.0569,
                            5.3352,
                            3.9263,
                            5.3324
                        ],
                        "confidence": 0.594,
                        "span": {
                            "offset": 97,
                            "length": 12
                        }
                    },
                    {
                        "content": "of",
                        "polygon": [
                            5.1042,
                            5.0962,
                            5.2908,
                            5.0954,
                            5.2902,
                            5.3349,
                            5.1036,
                            5.3352
                        ],
                        "confidence": 0.989,
                        "span": {
                            "offset": 110,
                            "length": 2
                        }
                    },
                    {
                        "content": "the",
                        "polygon": [
                            5.3374,
                            5.0952,
                            5.6484,
                            5.0976,
                            5.6481,
                            5.3366,
                            5.3368,
                            5.3349
                        ],
                        "confidence": 0.995,
                        "span": {
                            "offset": 113,
                            "length": 3
                        }
                    },
                    {
                        "content": "luxury",
                        "polygon": [
                            5.695,
                            5.098,
                            6.278,
                            5.0999,
                            6.2777,
                            5.3383,
                            5.6948,
                            5.3369
                        ],
                        "confidence": 0.991,
                        "span": {
                            "offset": 117,
                            "length": 6
                        }
                    },
                    {
                        "content": "jewelry",
                        "polygon": [
                            6.3364,
                            5.1003,
                            7.0189,
                            5.102,
                            7.0189,
                            5.339,
                            6.3361,
                            5.3385
                        ],
                        "confidence": 0.963,
                        "span": {
                            "offset": 124,
                            "length": 7
                        }
                    },
                    {
                        "content": "piece",
                        "polygon": [
                            1.3417,
                            5.3906,
                            1.9011,
                            5.3937,
                            1.9014,
                            5.6131,
                            1.3421,
                            5.6131
                        ],
                        "confidence": 0.988,
                        "span": {
                            "offset": 132,
                            "length": 5
                        }
                    },
                    {
                        "content": "described",
                        "polygon": [
                            1.9637,
                            5.3933,
                            2.8839,
                            5.39,
                            2.8842,
                            5.6131,
                            1.964,
                            5.6131
                        ],
                        "confidence": 0.986,
                        "span": {
                            "offset": 138,
                            "length": 9
                        }
                    },
                    {
                        "content": "below",
                        "polygon": [
                            2.9465,
                            5.3898,
                            3.5575,
                            5.3877,
                            3.5578,
                            5.6131,
                            2.9468,
                            5.6131
                        ],
                        "confidence": 0.963,
                        "span": {
                            "offset": 148,
                            "length": 5
                        }
                    },
                    {
                        "content": "and",
                        "polygon": [
                            3.6164,
                            5.3874,
                            3.9845,
                            5.3877,
                            3.9848,
                            5.6131,
                            3.6167,
                            5.6131
                        ],
                        "confidence": 0.912,
                        "span": {
                            "offset": 154,
                            "length": 3
                        }
                    },
                    {
                        "content": "confirms",
                        "polygon": [
                            4.0471,
                            5.3878,
                            4.8863,
                            5.3874,
                            4.8867,
                            5.6131,
                            4.0473,
                            5.6131
                        ],
                        "confidence": 0.847,
                        "span": {
                            "offset": 158,
                            "length": 8
                        }
                    },
                    {
                        "content": "that",
                        "polygon": [
                            4.9305,
                            5.3876,
                            5.3022,
                            5.389,
                            5.3027,
                            5.6131,
                            4.9309,
                            5.6131
                        ],
                        "confidence": 0.955,
                        "span": {
                            "offset": 167,
                            "length": 4
                        }
                    },
                    {
                        "content": "it",
                        "polygon": [
                            5.3464,
                            5.3888,
                            5.501,
                            5.3884,
                            5.5016,
                            5.6131,
                            5.3469,
                            5.6131
                        ],
                        "confidence": 0.989,
                        "span": {
                            "offset": 172,
                            "length": 2
                        }
                    },
                    {
                        "content": "is",
                        "polygon": [
                            5.5451,
                            5.3882,
                            5.6961,
                            5.388,
                            5.6968,
                            5.6131,
                            5.5458,
                            5.6131
                        ],
                        "confidence": 0.995,
                        "span": {
                            "offset": 175,
                            "length": 2
                        }
                    },
                    {
                        "content": "an",
                        "polygon": [
                            5.7439,
                            5.388,
                            5.9905,
                            5.3879,
                            5.9913,
                            5.6131,
                            5.7447,
                            5.6131
                        ],
                        "confidence": 0.657,
                        "span": {
                            "offset": 178,
                            "length": 2
                        }
                    },
                    {
                        "content": "original",
                        "polygon": [
                            6.0494,
                            5.3883,
                            6.7733,
                            5.3917,
                            6.7733,
                            5.6131,
                            6.0502,
                            5.6131
                        ],
                        "confidence": 0.962,
                        "span": {
                            "offset": 181,
                            "length": 8
                        }
                    },
                    {
                        "content": "design",
                        "polygon": [
                            2.1656,
                            5.692,
                            2.8445,
                            5.6935,
                            2.845,
                            5.929,
                            2.1659,
                            5.9259
                        ],
                        "confidence": 0.991,
                        "span": {
                            "offset": 190,
                            "length": 6
                        }
                    },
                    {
                        "content": "crafted",
                        "polygon": [
                            2.9017,
                            5.6933,
                            3.5653,
                            5.6943,
                            3.5659,
                            5.932,
                            2.9022,
                            5.9292
                        ],
                        "confidence": 0.816,
                        "span": {
                            "offset": 197,
                            "length": 7
                        }
                    },
                    {
                        "content": "by",
                        "polygon": [
                            3.6149,
                            5.6939,
                            3.859,
                            5.692,
                            3.8596,
                            5.9313,
                            3.6155,
                            5.9319
                        ],
                        "confidence": 0.995,
                        "span": {
                            "offset": 205,
                            "length": 2
                        }
                    },
                    {
                        "content": "the",
                        "polygon": [
                            3.9047,
                            5.6918,
                            4.2518,
                            5.6936,
                            4.2524,
                            5.9297,
                            3.9054,
                            5.9311
                        ],
                        "confidence": 0.995,
                        "span": {
                            "offset": 208,
                            "length": 3
                        }
                    },
                    {
                        "content": "specified",
                        "polygon": [
                            4.3166,
                            5.6945,
                            5.1747,
                            5.6977,
                            5.1756,
                            5.9241,
                            4.3173,
                            5.9295
                        ],
                        "confidence": 0.868,
                        "span": {
                            "offset": 212,
                            "length": 9
                        }
                    },
                    {
                        "content": "jeweler.",
                        "polygon": [
                            5.2319,
                            5.6978,
                            5.9623,
                            5.6992,
                            5.9623,
                            5.9217,
                            5.2328,
                            5.9238
                        ],
                        "confidence": 0.942,
                        "span": {
                            "offset": 222,
                            "length": 8
                        }
                    },
                    {
                        "content": "Employee",
                        "polygon": [
                            0.7327,
                            6.4214,
                            1.6901,
                            6.4162,
                            1.6901,
                            6.6829,
                            0.7325,
                            6.6839
                        ],
                        "confidence": 0.947,
                        "span": {
                            "offset": 231,
                            "length": 8
                        }
                    },
                    {
                        "content": "ID:",
                        "polygon": [
                            1.7414,
                            6.416,
                            1.9979,
                            6.4163,
                            1.998,
                            6.6768,
                            1.7414,
                            6.6822
                        ],
                        "confidence": 0.989,
                        "span": {
                            "offset": 240,
                            "length": 3
                        }
                    },
                    {
                        "content": "VE234567",
                        "polygon": [
                            2.0492,
                            6.4164,
                            3.0269,
                            6.4142,
                            3.0269,
                            6.664,
                            2.0493,
                            6.6756
                        ],
                        "confidence": 0.992,
                        "span": {
                            "offset": 244,
                            "length": 8
                        }
                    },
                    {
                        "content": "Certification",
                        "polygon": [
                            4.2321,
                            6.4492,
                            5.4817,
                            6.446,
                            5.4825,
                            6.6672,
                            4.233,
                            6.6666
                        ],
                        "confidence": 0.963,
                        "span": {
                            "offset": 253,
                            "length": 13
                        }
                    },
                    {
                        "content": "Date:",
                        "polygon": [
                            5.5429,
                            6.4461,
                            6.0615,
                            6.4453,
                            6.0625,
                            6.6669,
                            5.5437,
                            6.6672
                        ],
                        "confidence": 0.992,
                        "span": {
                            "offset": 267,
                            "length": 5
                        }
                    },
                    {
                        "content": "2022-09-10",
                        "polygon": [
                            6.1047,
                            6.4453,
                            7.2359,
                            6.4468,
                            7.2359,
                            6.6632,
                            6.1058,
                            6.6665
                        ],
                        "confidence": 0.992,
                        "span": {
                            "offset": 273,
                            "length": 10
                        }
                    },
                    {
                        "content": "Employee",
                        "polygon": [
                            0.7224,
                            7.3323,
                            1.6895,
                            7.3287,
                            1.6897,
                            7.5794,
                            0.7224,
                            7.5775
                        ],
                        "confidence": 0.988,
                        "span": {
                            "offset": 284,
                            "length": 8
                        }
                    },
                    {
                        "content": "Name:",
                        "polygon": [
                            1.7379,
                            7.3298,
                            2.4189,
                            7.3324,
                            2.4191,
                            7.577,
                            1.7381,
                            7.5787
                        ],
                        "confidence": 0.941,
                        "span": {
                            "offset": 293,
                            "length": 5
                        }
                    },
                    {
                        "content": "Jessica",
                        "polygon": [
                            2.4713,
                            7.3323,
                            3.2008,
                            7.3312,
                            3.201,
                            7.5742,
                            2.4715,
                            7.5768
                        ],
                        "confidence": 0.986,
                        "span": {
                            "offset": 299,
                            "length": 7
                        }
                    },
                    {
                        "content": "Taylor",
                        "polygon": [
                            3.2532,
                            7.331,
                            3.9121,
                            7.3332,
                            3.9121,
                            7.5696,
                            3.2535,
                            7.5741
                        ],
                        "confidence": 0.974,
                        "span": {
                            "offset": 307,
                            "length": 6
                        }
                    },
                    {
                        "content": "Expiration",
                        "polygon": [
                            4.2886,
                            7.3477,
                            5.3178,
                            7.3469,
                            5.3186,
                            7.5781,
                            4.2896,
                            7.5887
                        ],
                        "confidence": 0.976,
                        "span": {
                            "offset": 314,
                            "length": 10
                        }
                    },
                    {
                        "content": "Date:",
                        "polygon": [
                            5.3779,
                            7.3473,
                            5.8851,
                            7.3469,
                            5.8859,
                            7.574,
                            5.3787,
                            7.5776
                        ],
                        "confidence": 0.992,
                        "span": {
                            "offset": 325,
                            "length": 5
                        }
                    },
                    {
                        "content": "2024-09-10",
                        "polygon": [
                            5.9302,
                            7.3466,
                            7.0874,
                            7.3428,
                            7.0874,
                            7.5639,
                            5.931,
                            7.5735
                        ],
                        "confidence": 0.993,
                        "span": {
                            "offset": 331,
                            "length": 10
                        }
                    },
                    {
                        "content": "Gasparout",
                        "polygon": [
                            0.9897,
                            9.1867,
                            4.0491,
                            9.1375,
                            4.0491,
                            9.8246,
                            0.9921,
                            9.8786
                        ],
                        "confidence": 0.461,
                        "span": {
                            "offset": 342,
                            "length": 9
                        }
                    },
                    {
                        "content": "SAMANTHA",
                        "polygon": [
                            1.1731,
                            10.0345,
                            2.242,
                            10.0351,
                            2.2407,
                            10.2612,
                            1.1719,
                            10.2604
                        ],
                        "confidence": 0.989,
                        "span": {
                            "offset": 352,
                            "length": 8
                        }
                    },
                    {
                        "content": "WRIGHT",
                        "polygon": [
                            2.2904,
                            10.0347,
                            3.0668,
                            10.0332,
                            3.0668,
                            10.2601,
                            2.2892,
                            10.2612
                        ],
                        "confidence": 0.974,
                        "span": {
                            "offset": 361,
                            "length": 6
                        }
                    },
                    {
                        "content": "Authentication",
                        "polygon": [
                            0.8954,
                            10.3274,
                            2.3154,
                            10.3282,
                            2.3147,
                            10.5685,
                            0.8948,
                            10.5564
                        ],
                        "confidence": 0.903,
                        "span": {
                            "offset": 368,
                            "length": 14
                        }
                    },
                    {
                        "content": "Specialist",
                        "polygon": [
                            2.3975,
                            10.328,
                            3.3467,
                            10.3295,
                            3.3467,
                            10.5661,
                            2.3971,
                            10.569
                        ],
                        "confidence": 0.881,
                        "span": {
                            "offset": 383,
                            "length": 10
                        }
                    },
                    {
                        "content": "[certificate.issued_on]",
                        "polygon": [
                            4.9401,
                            10.0259,
                            7.1445,
                            10.0126,
                            7.1445,
                            10.275,
                            4.9405,
                            10.284
                        ],
                        "confidence": 0.747,
                        "span": {
                            "offset": 394,
                            "length": 23
                        }
                    },
                    {
                        "content": "certificato",
                        "polygon": [
                            5.5043,
                            10.3556,
                            6.1964,
                            10.3571,
                            6.197,
                            10.5264,
                            5.5041,
                            10.5296
                        ],
                        "confidence": 0.612,
                        "span": {
                            "offset": 418,
                            "length": 11
                        }
                    },
                    {
                        "content": "Luid",
                        "polygon": [
                            6.2299,
                            10.357,
                            6.5848,
                            10.3534,
                            6.5848,
                            10.5283,
                            6.2305,
                            10.5262
                        ],
                        "confidence": 0.11,
                        "span": {
                            "offset": 430,
                            "length": 4
                        }
                    }
                ],
                "selectionMarks": [
                    {
                        "state": "unselected",
                        "polygon": [
                            5.7542,
                            9.2549,
                            5.9133,
                            9.2549,
                            5.9133,
                            9.4185,
                            5.7542,
                            9.4185
                        ],
                        "confidence": 0.1,
                        "span": {
                            "offset": 435,
                            "length": 12
                        }
                    },
                    {
                        "state": "unselected",
                        "polygon": [
                            6.1576,
                            9.251,
                            6.319,
                            9.251,
                            6.319,
                            9.4196,
                            6.1576,
                            9.4196
                        ],
                        "confidence": 0.1,
                        "span": {
                            "offset": 448,
                            "length": 12
                        }
                    },
                    {
                        "state": "unselected",
                        "polygon": [
                            5.747,
                            9.6729,
                            5.9118,
                            9.6729,
                            5.9118,
                            9.8456,
                            5.747,
                            9.8456
                        ],
                        "confidence": 0.1,
                        "span": {
                            "offset": 461,
                            "length": 12
                        }
                    },
                    {
                        "state": "selected",
                        "polygon": [
                            5.7542,
                            9.5114,
                            5.9069,
                            9.5114,
                            5.9069,
                            9.6434,
                            5.7542,
                            9.6434
                        ],
                        "confidence": 0.1,
                        "span": {
                            "offset": 474,
                            "length": 10
                        }
                    }
                ],
                "lines": [
                    {
                        "content": "O",
                        "polygon": [
                            3.762,
                            0.9853,
                            4.4891,
                            0.9838,
                            4.4904,
                            1.6772,
                            3.7634,
                            1.6786
                        ],
                        "spans": [
                            {
                                "offset": 0,
                                "length": 1
                            }
                        ]
                    },
                    {
                        "content": "Visible Emissions Evaluator",
                        "polygon": [
                            0.619,
                            2.1299,
                            7.6336,
                            2.1466,
                            7.6322,
                            2.6991,
                            0.6176,
                            2.6817
                        ],
                        "spans": [
                            {
                                "offset": 2,
                                "length": 27
                            }
                        ]
                    },
                    {
                        "content": "Field Certification",
                        "polygon": [
                            1.7494,
                            3.1083,
                            6.4806,
                            3.1088,
                            6.4806,
                            3.6706,
                            1.7493,
                            3.6701
                        ],
                        "spans": [
                            {
                                "offset": 30,
                                "length": 19
                            }
                        ]
                    },
                    {
                        "content": "recipient.name",
                        "polygon": [
                            2.3244,
                            3.9981,
                            5.9547,
                            3.9914,
                            5.9564,
                            4.5386,
                            2.3257,
                            4.5498
                        ],
                        "spans": [
                            {
                                "offset": 50,
                                "length": 14
                            }
                        ]
                    },
                    {
                        "content": "This certificate ottests to the authenticity of the luxury jewelry",
                        "polygon": [
                            1.1085,
                            5.0878,
                            7.0146,
                            5.0998,
                            7.014,
                            5.3383,
                            1.1079,
                            5.3221
                        ],
                        "spans": [
                            {
                                "offset": 65,
                                "length": 66
                            }
                        ]
                    },
                    {
                        "content": "piece described below and confirms that it is an original",
                        "polygon": [
                            1.3417,
                            5.3887,
                            6.7683,
                            5.3853,
                            6.7684,
                            5.6104,
                            1.3418,
                            5.6131
                        ],
                        "spans": [
                            {
                                "offset": 132,
                                "length": 57
                            }
                        ]
                    },
                    {
                        "content": "design crafted by the specified jeweler.",
                        "polygon": [
                            2.1656,
                            5.6919,
                            5.9599,
                            5.6903,
                            5.96,
                            5.927,
                            2.1657,
                            5.9286
                        ],
                        "spans": [
                            {
                                "offset": 190,
                                "length": 40
                            }
                        ]
                    },
                    {
                        "content": "Employee ID: VE234567",
                        "polygon": [
                            0.731,
                            6.4203,
                            3.0248,
                            6.4125,
                            3.0267,
                            6.6687,
                            0.7325,
                            6.6855
                        ],
                        "spans": [
                            {
                                "offset": 231,
                                "length": 21
                            }
                        ]
                    },
                    {
                        "content": "Certification Date: 2022-09-10",
                        "polygon": [
                            4.2321,
                            6.4444,
                            7.2333,
                            6.4451,
                            7.2333,
                            6.6647,
                            4.232,
                            6.664
                        ],
                        "spans": [
                            {
                                "offset": 253,
                                "length": 30
                            }
                        ]
                    },
                    {
                        "content": "Employee Name: Jessica Taylor",
                        "polygon": [
                            0.7224,
                            7.3267,
                            3.9086,
                            7.3265,
                            3.9086,
                            7.5779,
                            0.7224,
                            7.5781
                        ],
                        "spans": [
                            {
                                "offset": 284,
                                "length": 29
                            }
                        ]
                    },
                    {
                        "content": "Expiration Date: 2024-09-10",
                        "polygon": [
                            4.2886,
                            7.3466,
                            7.0821,
                            7.3376,
                            7.0831,
                            7.5764,
                            4.2896,
                            7.588
                        ],
                        "spans": [
                            {
                                "offset": 314,
                                "length": 27
                            }
                        ]
                    },
                    {
                        "content": "Gasparout",
                        "polygon": [
                            0.988,
                            9.187,
                            4.0436,
                            9.1363,
                            4.0491,
                            9.8211,
                            0.9923,
                            9.8786
                        ],
                        "spans": [
                            {
                                "offset": 342,
                                "length": 9
                            }
                        ]
                    },
                    {
                        "content": "SAMANTHA WRIGHT",
                        "polygon": [
                            1.1719,
                            10.0335,
                            3.0649,
                            10.0328,
                            3.065,
                            10.2586,
                            1.1719,
                            10.2593
                        ],
                        "spans": [
                            {
                                "offset": 352,
                                "length": 15
                            }
                        ]
                    },
                    {
                        "content": "Authentication Specialist",
                        "polygon": [
                            0.8954,
                            10.3216,
                            3.3421,
                            10.3292,
                            3.3413,
                            10.5685,
                            0.8947,
                            10.561
                        ],
                        "spans": [
                            {
                                "offset": 368,
                                "length": 25
                            }
                        ]
                    },
                    {
                        "content": "[certificate.issued_on]",
                        "polygon": [
                            4.9401,
                            10.0222,
                            7.1401,
                            10.0126,
                            7.1412,
                            10.2706,
                            4.9405,
                            10.2802
                        ],
                        "spans": [
                            {
                                "offset": 394,
                                "length": 23
                            }
                        ]
                    },
                    {
                        "content": "certificato Luid",
                        "polygon": [
                            5.5035,
                            10.3556,
                            6.5808,
                            10.3526,
                            6.5813,
                            10.5252,
                            5.5041,
                            10.5288
                        ],
                        "spans": [
                            {
                                "offset": 418,
                                "length": 16
                            }
                        ]
                    }
                ],
                "spans": [
                    {
                        "offset": 0,
                        "length": 484
                    }
                ]
            }
        ],
        "tables": [],
        "paragraphs": [
            {
                "spans": [
                    {
                        "offset": 0,
                        "length": 1
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            3.762,
                            0.9853,
                            4.4891,
                            0.9838,
                            4.4904,
                            1.6772,
                            3.7634,
                            1.6786
                        ]
                    }
                ],
                "content": "O"
            },
            {
                "spans": [
                    {
                        "offset": 2,
                        "length": 47
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            0.619,
                            2.1299,
                            7.6336,
                            2.1466,
                            7.6299,
                            3.6841,
                            0.6153,
                            3.6675
                        ]
                    }
                ],
                "role": "title",
                "content": "Visible Emissions Evaluator Field Certification"
            },
            {
                "spans": [
                    {
                        "offset": 50,
                        "length": 14
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            2.3244,
                            3.9981,
                            5.9552,
                            3.9899,
                            5.9564,
                            4.5416,
                            2.3257,
                            4.5498
                        ]
                    }
                ],
                "content": "recipient.name"
            },
            {
                "spans": [
                    {
                        "offset": 65,
                        "length": 165
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            1.1084,
                            5.0878,
                            7.0146,
                            5.0998,
                            7.0129,
                            5.9385,
                            1.1067,
                            5.9265
                        ]
                    }
                ],
                "content": "This certificate ottests to the authenticity of the luxury jewelry piece described below and confirms that it is an original design crafted by the specified jeweler."
            },
            {
                "spans": [
                    {
                        "offset": 231,
                        "length": 21
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            0.731,
                            6.4203,
                            3.0253,
                            6.4072,
                            3.0268,
                            6.6724,
                            0.7325,
                            6.6855
                        ]
                    }
                ],
                "content": "Employee ID: VE234567"
            },
            {
                "spans": [
                    {
                        "offset": 253,
                        "length": 30
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            4.2321,
                            6.4444,
                            7.2333,
                            6.4451,
                            7.2333,
                            6.6647,
                            4.232,
                            6.664
                        ]
                    }
                ],
                "content": "Certification Date: 2022-09-10"
            },
            {
                "spans": [
                    {
                        "offset": 284,
                        "length": 29
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            0.7224,
                            7.3267,
                            3.9086,
                            7.3265,
                            3.9086,
                            7.5779,
                            0.7224,
                            7.5781
                        ]
                    }
                ],
                "content": "Employee Name: Jessica Taylor"
            },
            {
                "spans": [
                    {
                        "offset": 314,
                        "length": 27
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            4.2886,
                            7.3466,
                            7.0821,
                            7.335,
                            7.0831,
                            7.5764,
                            4.2896,
                            7.588
                        ]
                    }
                ],
                "content": "Expiration Date: 2024-09-10"
            },
            {
                "spans": [
                    {
                        "offset": 342,
                        "length": 9
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            0.9808,
                            9.1871,
                            4.0436,
                            9.1363,
                            4.0551,
                            9.8278,
                            0.9923,
                            9.8786
                        ]
                    }
                ],
                "content": "Gasparout"
            },
            {
                "spans": [
                    {
                        "offset": 352,
                        "length": 41
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            0.8964,
                            10.0261,
                            3.343,
                            10.0336,
                            3.3413,
                            10.5685,
                            0.8947,
                            10.561
                        ]
                    }
                ],
                "content": "SAMANTHA WRIGHT Authentication Specialist"
            },
            {
                "spans": [
                    {
                        "offset": 394,
                        "length": 40
                    }
                ],
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            4.9394,
                            10.0222,
                            7.1401,
                            10.0126,
                            7.1423,
                            10.5228,
                            4.9416,
                            10.5324
                        ]
                    }
                ],
                "content": "[certificate.issued_on] certificato Luid"
            }
        ],
        "styles": [
            {
                "confidence": 1,
                "spans": [
                    {
                        "offset": 342,
                        "length": 9
                    }
                ],
                "isHandwritten": true
            }
        ],
        "contentFormat": "text",
        "sections": [
            {
                "spans": [
                    {
                        "offset": 0,
                        "length": 434
                    }
                ],
                "elements": [
                    "/sections/1",
                    "/sections/2"
                ]
            },
            {
                "spans": [
                    {
                        "offset": 0,
                        "length": 1
                    }
                ],
                "elements": [
                    "/figures/0"
                ]
            },
            {
                "spans": [
                    {
                        "offset": 2,
                        "length": 432
                    }
                ],
                "elements": [
                    "/paragraphs/1",
                    "/paragraphs/2",
                    "/paragraphs/3",
                    "/paragraphs/4",
                    "/paragraphs/5",
                    "/paragraphs/6",
                    "/paragraphs/7",
                    "/paragraphs/8",
                    "/paragraphs/9",
                    "/figures/1"
                ]
            }
        ],
        "figures": [
            {
                "id": "1.1",
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            3.7335,
                            0.9959,
                            4.5139,
                            0.9958,
                            4.5139,
                            1.6907,
                            3.7336,
                            1.6908
                        ]
                    }
                ],
                "spans": [
                    {
                        "offset": 0,
                        "length": 1
                    }
                ],
                "elements": [
                    "/paragraphs/0"
                ]
            },
            {
                "id": "1.2",
                "boundingRegions": [
                    {
                        "pageNumber": 1,
                        "polygon": [
                            4.9047,
                            9.1795,
                            7.2656,
                            9.1789,
                            7.2651,
                            10.6071,
                            4.9042,
                            10.6076
                        ]
                    }
                ],
                "spans": [
                    {
                        "offset": 394,
                        "length": 40
                    }
                ],
                "elements": [
                    "/paragraphs/10"
                ]
            }
        ]
    }
};
let jsonData = {
    "$schema": "https://schema.cognitiveservices.azure.com/formrecognizer/2021-03-01/fields.json",
    "fields": []
};
let jsonStructure = {
    "$schema": "https://schema.cognitiveservices.azure.com/formrecognizer/2021-03-01/labels.json",
    "document": "Visible Emissions Evaluator Field Certification(2).pdf",
    "labels": []
};

let labelsArray = [];
let contentArray = [];
let boundingBoxArray = [];

function selectAndHighlight() {
    let pdfCanvas = document.querySelector('.pdf-page');
    let overlayCanvas = document.querySelector('.highlight-canvas');
    let ctxOverlay = overlayCanvas.getContext('2d');
    let pdfPage, pdfScale = 1.5;
    let isDrawing = false, startX, startY, endX, endY;

    // Array to store drawn rectangles
    let rectangles = [];
    let words = ocrExtractedJSON.analyzeResult.pages[0].words
    overlayCanvas.addEventListener('mousedown', (event) => {
        isDrawing = true;
        startX = event.offsetX;
        startY = event.offsetY;
        // Optionally, clear only the "current" drawing state here
    });

    overlayCanvas.addEventListener('mousemove', (event) => {
        if (!isDrawing) return;
        endX = event.offsetX;
        endY = event.offsetY;
        drawOverlay();
    });

    overlayCanvas.addEventListener('mouseup', () => {
        debugger;
        isDrawing = false;

        // Store the drawn rectangle data
        let rect = {
            x: startX,
            y: startY,
            width: endX - startX,
            height: endY - startY
        };
        rectangles.push(rect);

        // Find words inside the selected area
        words.forEach(word => {
            if (isWordInsideRectangle(word)) {
                contentArray.push(word.content);
                boundingBoxArray.push(word.polygon);
            }
        });

        drawOverlay(); // Redraw to include the new rectangle
    });

    function drawOverlay() {
        // Clear the canvas
        ctxOverlay.clearRect(0, 0, overlayCanvas.width, overlayCanvas.height);

        // Draw all previously stored rectangles
        // rectangles.forEach(rect => {
        //     ctxOverlay.strokeStyle = "red";
        //     ctxOverlay.lineWidth = 2;
        //     ctxOverlay.strokeRect(rect.x, rect.y, rect.width, rect.height);
        // });

        // Draw the current rectangle if still drawing
        //if (isDrawing) {
        ctxOverlay.strokeStyle = "red";
        ctxOverlay.lineWidth = 2;
        ctxOverlay.strokeRect(startX, startY, endX - startX, endY - startY);
        //   }
    }

    function isWordInsideRectangle(word) {
        let rect = {
            x: startX,
            y: startY,
            width: endX - startX,
            height: endY - startY
        };

        let [x1, y1, x2, y2, x3, y3, x4, y4] = word.polygon;

        // Find the min/max coordinates of the word
        let wordMinX = Math.min(x1, x2, x3, x4);
        let wordMaxX = Math.max(x1, x2, x3, x4);
        let wordMinY = Math.min(y1, y2, y3, y4);
        let wordMaxY = Math.max(y1, y2, y3, y4);

        rect.x = rect.x / 72;
        rect.y = rect.y / 72;
        rect.width = rect.width / 72;
        rect.height = rect.height / 72;
        // Check if the word's bounding box overlaps with the selected rectangle
        return (
            wordMinX >= rect.x && wordMaxX <= rect.x + rect.width &&
            wordMinY >= rect.y && wordMaxY <= rect.y + rect.height
        );
    }
}


/*Create Tabs*/


const tabContainer = document.createElement("div");
tabContainer.id = "tab-container";
tabContainer.className = "tabs-wrapper";
// Create tab buttons
const tabButtons = document.createElement("div");
tabButtons.id = "tab-buttons";
tabButtons.className = "tabs-header";

const fieldsTabButton = document.createElement("button");
fieldsTabButton.innerText = "Fields";
fieldsTabButton.className = "tab-button fields-button";
fieldsTabButton.classList.add("active");
fieldsTabButton.onclick = () => switchTab("fields");

const tablesTabButton = document.createElement("button");
tablesTabButton.innerText = "Tables";
tablesTabButton.className = "tab-button tables-button";
tablesTabButton.onclick = () => switchTab("tables");

tabButtons.appendChild(fieldsTabButton);
tabButtons.appendChild(tablesTabButton);

// Create tab contents
const fieldsTab = document.createElement("div");
fieldsTab.id = "fields";
fieldsTab.className = "tab-content fields-content";

const createFieldButton = document.createElement("button");
createFieldButton.innerText = "Create New Field";
createFieldButton.className = "create-button";

const fieldsContainer = document.createElement("div");
fieldsContainer.id = "fields-container";
fieldsContainer.className = "content-container";

fieldsTab.appendChild(createFieldButton);
fieldsTab.appendChild(fieldsContainer);

const tablesTab = document.createElement("div");
tablesTab.id = "tables";
tablesTab.className = "tab-content tables-content";
tablesTab.style.display = "none";

const createTableButton = document.createElement("button");
createTableButton.innerText = "Create New Table";
createTableButton.className = "create-button";

const tablesContainer = document.createElement("div");
tablesContainer.id = "tables-container";
tablesContainer.className = "content-container";


tablesTab.appendChild(createTableButton);
tablesTab.appendChild(tablesContainer);

// Append everything to main container
tabContainer.appendChild(tabButtons);
tabContainer.appendChild(fieldsTab);
tabContainer.appendChild(tablesTab);
tabContainerColumn = document.getElementById('platform_id_4mszTiuY-2');

// Append to body
tabContainerColumn.appendChild(tabContainer);


function switchTab(tabId) {
    fieldsTabButton.classList.remove("active");
    tablesTabButton.classList.remove("active");
    if (tabId === "fields") {
        fieldsTabButton.classList.add("active");
    } else if (tabId === "tables") {
        tablesTabButton.classList.add("active");
    }
    document.getElementById("fields").style.display = tabId === "fields" ? "block" : "none";
    document.getElementById("tables").style.display = tabId === "tables" ? "block" : "none";
}

createFieldButton.onclick = function () {
    debugger;
    let popup = document.getElementById('popup');

    // Remove existing popup if it exists
    if (popup) {
        popup.remove();
    }

    popup = document.createElement('div');
    popup.id = 'popup';
    popup.style.position = 'absolute';

    // Get button position
    const buttonRect = createFieldButton.getBoundingClientRect();
    const scaleFactor = window.devicePixelRatio || 1;

    // Define popup width (adjust as needed)
    const popupWidth = 350; // Set a fixed width or calculate dynamically

    // Calculate left position to extend left if width is greater
    let leftPosition = buttonRect.left + window.scrollX;
    if (popupWidth > buttonRect.width) {
        leftPosition = buttonRect.left + window.scrollX - (popupWidth - buttonRect.width);
    }

    // Set position and styling
    popup.style.setProperty("top", "169px", "important");
    //popup.style.left = `${leftPosition}px !important`;
    popup.style.setProperty("left", `${leftPosition}px`, "important");
    popup.style.width = `${popupWidth}px`;
    popup.style.padding = '20px';
    popup.style.backgroundColor = 'white';
    popup.style.border = '1px solid #ccc';
    popup.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.1)';
    popup.style.transform = "none";

    // Popup Content
    popup.innerHTML = `
        <input type="text" id="fieldInput" placeholder="Create new field and hit enter" onkeydown="handleEnter(event)" style="width: 100%;"/>
        <div id="errorMessage" style="color: red; font-size: 12px; display: none;">Field cannot be empty.</div>
    `;

    fieldsContainer.appendChild(popup);
    let fieldInput = document.getElementById('fieldInput');
    fieldInput.addEventListener("keydown", handleEnter);
    popup.addEventListener('click', function (event) {
        event.stopPropagation(); // Prevent the event from propagating to the document
    });

    fieldInput.addEventListener('click', function (event) {
        event.stopPropagation(); // Prevent the event from propagating to the document
    });

    // Remove the previous document click listener if it exists
    if (window.popupClickListener) {
        document.removeEventListener("click", window.popupClickListener);
    }

    // Add a new document click listener
    window.popupClickListener = function (event) {
        if (!popup.contains(event.target) && event.target !== fieldInput) {
            closePopup1();
        }
    };

    // Delay adding the document click listener to avoid immediate closing
    setTimeout(function () {
        document.addEventListener("click", window.popupClickListener);
    }, 0);
};


function closePopup1() {
    const popup = document.getElementById('popup');
    if (popup) {
        popup.remove(); // Remove the popup from the DOM
    }
    // Remove the document click listener when the popup is closed
    if (window.popupClickListener) {
        document.removeEventListener("click", window.popupClickListener);
        window.popupClickListener = null; // Clear the reference
    }
}


createTableButton.onclick = function () {
    debugger;
    let popup = document.getElementById('popup');

    // Remove existing popup if it exists
    if (popup) {
        popup.remove();
    }

    popup = document.createElement('div');
    popup.id = 'popup';
    popup.style.position = 'absolute';

    // Get button position
    const buttonRect = createTableButton.getBoundingClientRect();
    const popupWidth = 350; // Set a fixed popup width

    // Calculate left position (extend left if popup is wider)
    let leftPosition = buttonRect.left + window.scrollX;
    if (popupWidth > buttonRect.width) {
        leftPosition = buttonRect.left + window.scrollX - (popupWidth - buttonRect.width);
    }

    // **Set fixed top position to 212px**
    popup.style.setProperty("top", "169px", "important");
    //popup.style.left = `${leftPosition}px !important`;
    popup.style.setProperty("left", `${leftPosition}px`, "important");
    popup.style.width = `${popupWidth}px`;
    popup.style.padding = '20px';
    popup.style.backgroundColor = 'white';
    popup.style.border = '1px solid #ccc';
    popup.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.1)';
    popup.style.transform = "none";

    // Popup Content
    popup.innerHTML = `
        <input type="text" id="tableInput" placeholder="Create table field and hit enter" onkeydown="handleEnterTable(event)" style="width: 100%;"/> 
        <div id="errorMessage" style="color: red; font-size: 12px; display: none;">Table name cannot be empty.</div> 
    `;

    tablesContainer.appendChild(popup);
    let fieldInput = document.getElementById('tableInput');
    fieldInput.addEventListener("keydown", handleEnterTable);
    popup.addEventListener('click', function (event) {
        event.stopPropagation(); // Prevent the event from propagating to the document
    });

    fieldInput.addEventListener('click', function (event) {
        event.stopPropagation(); // Prevent the event from propagating to the document
    });

    // Remove the previous document click listener if it exists
    if (window.popupClickListener) {
        document.removeEventListener("click", window.popupClickListener);
    }
    // Add a new document click listener
    window.popupClickListener = function (event) {
        if (!popup.contains(event.target) && event.target !== fieldInput) {
            closePopup();
        }
    };

    // Delay adding the document click listener to avoid immediate closing
    setTimeout(function () {
        document.addEventListener("click", window.popupClickListener);
    }, 0);
}
function handleEnterTable(event) {

    if (event.key === 'Enter') {
        debugger;
        const tableName = document.getElementById("tableInput").value.trim();
        if (tableName) {
            // Adding the new field to the JSON
            jsonData.fields.push({
                "fieldKey": tableName,
                "fieldType": "Array",
                "fieldFormat": "not-specified"
            });
            console.log(jsonData); // Log the updated JSON
            createTable(tableName);
            closePopup();
        } else {
            document.getElementById("errorMessage").style.display = "block"; // Show error message
        }
    }
}
function createTable(tableName) {

    //let tableNumber = 0;

    let tableNumber = document.querySelectorAll('.table-content-container').length + 1;
    const tableContainer = document.createElement("div");
    tableContainer.id = "table-container_" + tableNumber;  // Unique container ID
    tableContainer.className = "table-content-container";

    // Create a wrapper for the input and icons
    const inputContainer = document.createElement("div");
    inputContainer.className = "input-container";

    const input = document.createElement("input");
    input.type = "text";
    input.className = "table-name-input";
    input.value = tableName;
    input.disabled = true; // Initially disable the input field

    // Create the SVG settings icon
    const settingsIcon = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    settingsIcon.setAttribute("class", "svg-inline--fa fa-gear settings-icon");
    settingsIcon.setAttribute("aria-hidden", "true");
    settingsIcon.setAttribute("focusable", "false");
    settingsIcon.setAttribute("data-prefix", "fas");
    settingsIcon.setAttribute("data-icon", "gear");
    settingsIcon.setAttribute("role", "img");
    settingsIcon.setAttribute("xmlns", "http://www.w3.org/2000/svg");
    settingsIcon.setAttribute("viewBox", "0 0 512 512");

    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("fill", "currentColor");
    path.setAttribute("d", "M495.9 166.6C499.2 175.2 496.4 184.9 489.6 191.2L446.3 230.6C447.4 238.9 448 247.4 448 256C448 264.6 447.4 273.1 446.3 281.4L489.6 320.8C496.4 327.1 499.2 336.8 495.9 345.4C491.5 357.3 486.2 368.8 480.2 379.7L475.5 387.8C468.9 398.8 461.5 409.2 453.4 419.1C447.4 426.2 437.7 428.7 428.9 425.9L373.2 408.1C359.8 418.4 344.1 427 329.2 433.6L316.7 490.7C314.7 499.7 307.7 506.1 298.5 508.5C284.7 510.8 270.5 512 255.1 512C241.5 512 227.3 510.8 213.5 508.5C204.3 506.1 197.3 499.7 195.3 490.7L182.8 433.6C167 427 152.2 418.4 138.8 408.1L83.14 425.9C74.3 428.7 64.55 426.2 58.63 419.1C50.52 409.2 43.12 398.8 36.52 387.8L31.84 379.7C25.77 368.8 20.49 357.3 16.06 345.4C12.82 336.8 15.55 327.1 22.41 320.8L65.67 281.4C64.57 273.1 64 264.6 64 256C64 247.4 64.57 238.9 65.67 230.6L22.41 191.2C15.55 184.9 12.82 175.3 16.06 166.6C20.49 154.7 25.78 143.2 31.84 132.3L36.51 124.2C43.12 113.2 50.52 102.8 58.63 92.95C64.55 85.8 74.3 83.32 83.14 86.14L138.8 103.9C152.2 93.56 167 84.96 182.8 78.43L195.3 21.33C197.3 12.25 204.3 5.04 213.5 3.51C227.3 1.201 241.5 0 256 0C270.5 0 284.7 1.201 298.5 3.51C307.7");

    settingsIcon.appendChild(path);

    // Add event listener to the settings icon to enable the input field when clicked
    settingsIcon.addEventListener("click", function () {
        // Check if the input is disabled and enable it when clicked
        if (input.disabled) {
            input.disabled = false;  // Enable the input field
        } else {
            input.disabled = true; // Disable the input field
        }
    });

    // Create the SVG delete icon
    const deleteIcon = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    deleteIcon.setAttribute("class", "svg-inline--fa fa-trash delete-icon");
    deleteIcon.setAttribute("aria-hidden", "true");
    deleteIcon.setAttribute("focusable", "false");
    deleteIcon.setAttribute("data-prefix", "fas");
    deleteIcon.setAttribute("data-icon", "trash");
    deleteIcon.setAttribute("role", "img");
    deleteIcon.setAttribute("xmlns", "http://www.w3.org/2000/svg");
    deleteIcon.setAttribute("viewBox", "0 0 512 512");

    const deletePath = document.createElementNS("http://www.w3.org/2000/svg", "path");
    deletePath.setAttribute("fill", "currentColor");
    deletePath.setAttribute("d", "M375 64h-81.3l-9.4-28.3C283.3 19.3 270.8 0 256 0s-27.3 19.3-28.3 35.7L218.3 64H137c-18.6 0-32 14.4-32 32s14.4 32 32 32h16v352c0 17.7 14.3 32 32 32h224c17.7 0 32-14.3 32-32V128h16c18.6 0 32-14.4 32-32s-14.4-32-32-32zM368 480H144V128h224v352z");

    deleteIcon.appendChild(deletePath);

    // Add event listener to the delete icon to remove the input container
    deleteIcon.addEventListener("click", function () {
        tableContainer.remove();// Remove the entire input container (including input and icons)
    });

    // Append input and icons to input container
    inputContainer.appendChild(input);
    inputContainer.appendChild(settingsIcon);
    inputContainer.appendChild(deleteIcon);

    // Append input container to table container
    tableContainer.appendChild(inputContainer);




    document.body.appendChild(tableContainer);

    const table = document.createElement("table");
    table.setAttribute('data-table-id', 'table-' + tableNumber);  // Unique identifier for the table
    tableContainer.appendChild(table);

    table.id = "dynamicTable";
    const thead = document.createElement("thead");
    const tbody = document.createElement("tbody");
    table.appendChild(thead);
    table.appendChild(tbody);
    tableContainer.appendChild(table);
    tablesContainer.appendChild(tableContainer);
    table.setAttribute("name", tableName);

    createHeader(thead);
    createRow(tbody, 0);

    thead.addEventListener("click", function (event) {
        debugger;
        if (event.target.classList.contains("down-arrow")) {
            const columnIndex = Array.from(event.target.parentElement.parentElement.children).indexOf(event.target.parentElement);
            showPopup(event.target, ["Rename Column", "Insert Column", "Delete Column"], action => {
                if (action === "Insert Column") {
                    insertColumnAt(columnIndex, thead, tbody);
                } else if (action === "Delete Column") {
                    deleteColumn(columnIndex, thead, tbody, table);
                }
                else if (action === "Rename Column") {
                    renameColumn(columnIndex, thead, table);
                }
            });
        }
    });
    tbody.addEventListener("click", function (event) {
        debugger;
        if (event.target.classList.contains("down-arrow")) {
            const rowIndex = Array.from(event.target.closest("tr").parentElement.children).indexOf(event.target.closest("tr"));
            showPopup(event.target, ["Insert Row", "Delete Row"], action => {
                if (action === "Insert Row") {
                    insertRowBelow(rowIndex, thead, tbody, table);
                } else if (action === "Delete Row") {
                    deleteRow(rowIndex, tbody, table);
                }
            });
        }
    });
    tbody.addEventListener("click", function (event) {
        debugger;
        if (event.target.tagName === "TD" && !event.target.classList.contains("down-arrow")) {
            const clickedCell = event.target;
            const rowIndex = Array.from(tbody.children).indexOf(clickedCell.parentElement);
            const colIndex = Array.from(clickedCell.parentElement.children).indexOf(clickedCell);
            const colName = thead.children[0].children[colIndex].querySelector('.editable-span').textContent.trim();

            if (contentArray.length > 0 && boundingBoxArray.length > 0) {
                const labelName = tableName + "/" + rowIndex + "/" + colName; // Get label name
                let existingLabel = jsonStructure.labels.find(l => l.label === labelName);

                if (!existingLabel) {
                    // Create a new label object if it doesn't exist
                    existingLabel = {
                        label: labelName,
                        value: []
                    };
                    jsonStructure.labels.push(existingLabel);
                }

                // Add values to the existing label object
                contentArray.forEach((text, i) => {
                    const canvas = document.getElementsByClassName("pdf-page")[0];

                    // Get its rendered size on the page
                    const rect = canvas.getBoundingClientRect();
                    const renderedWidth = rect.width;
                    const renderedHeight = rect.height;

                    const scaledBoundingBox = boundingBoxArray[i].map((value, index) => {
                        if (index % 2 === 0) {
                            // x-coordinate: multiply by 72 then divide by the rendered width
                            return value * 72 / renderedWidth;
                        } else {
                            // y-coordinate: multiply by 72 then divide by the rendered height
                            return value * 72 / renderedHeight;
                        }
                    });
                    let valueObject = {
                        page: 1, // Keep page as 1
                        text: text, // Use text from contentArray
                        boundingBoxes: scaledBoundingBox // Use boundingBox from boundingBoxArray
                    };
                    existingLabel.value.push(valueObject);
                    //   drawRectangle(boundingBoxArray[i]);
                });
                function drawRectangle(coords) {
                    const canvas = document.getElementsByClassName("pdf-page")[0];
                    const ctx = canvas.getContext("2d");
                    const points = [
                        { x: coords[0], y: coords[1] },
                        { x: coords[2], y: coords[3] },
                        { x: coords[4], y: coords[5] },
                        { x: coords[6], y: coords[7] }
                    ];
                    const zoomLevel = getZoomLevel();
                    function getZoomLevel() {
                        const screenWidth = window.innerWidth;
                        const docWidth = document.documentElement.clientWidth;
                        return screenWidth / docWidth;
                    }
                    // Convert the points to the correct scale/viewport space
                    points.forEach(point => {
                        point.x = point.x * 72 * zoomLevel;
                        point.y = point.y * 72 * zoomLevel;
                    });
                    // Draw the polygon on the canvas
                    ctx.beginPath();
                    ctx.moveTo(points[0].x, points[0].y);

                    // Draw lines to the other points
                    points.forEach((point, index) => {
                        if (index > 0) {
                            ctx.lineTo(point.x, point.y);
                        }
                    });

                    // Close the path (complete the polygon)
                    ctx.closePath();

                    // Apply styling for the highlight (e.g., semi-transparent fill)

                    // Apply styling for the highlight (e.g., semi-transparent fill)
                    // ctx.fillStyle = 'rgba(255, 0, 0, 0.3)'; // Red with transparency
                    // ctx.fill();
                    ctx.lineWidth = 2;
                    ctx.strokeStyle = 'red';
                    ctx.stroke();
                }

                // Append the new values to the existing input value
                const existingValue = clickedCell.textContent.trim();
                clickedCell.textContent = existingValue
                    ? existingValue + " " + contentArray.join(" ")
                    : contentArray.join(" ");

                // Log the updated JSON structure (for debugging)
                console.log(JSON.stringify(jsonStructure, null, 2));

                contentArray.length = 0;
                boundingBoxArray.length = 0;
            }


            // Show Selected Cell Info
            console.log(`Row: ${rowIndex}, Column: ${colName}`);
            document.getElementById("selectedCellInfo").textContent = `Row: ${rowIndex}, Column: ${colName}`;
        }
    });
}
function createHeader(thead) {
    const headerRow = document.createElement("tr");
    const firstHeaderCell = document.createElement("th");
    firstHeaderCell.textContent = "#";
    headerRow.appendChild(firstHeaderCell);

    const headerCell = document.createElement("th");
    headerCell.classList.add("header-cell");


    const textSpan = document.createElement("span");
    textSpan.innerText = "Column 1"; // Editable text
    textSpan.classList.add('editable-span');
    headerCell.appendChild(textSpan);

    const iconSpan = document.createElement("span");
    iconSpan.classList.add("down-arrow");
    iconSpan.innerHTML = "^";

    // Append the icon to the header cell
    headerCell.appendChild(iconSpan);


    headerRow.appendChild(headerCell);
    thead.appendChild(headerRow);
}

function createRow(tbody, rowNumber) {
    const row = document.createElement("tr");

    const indexCell = document.createElement("td");
    indexCell.innerHTML = `#${rowNumber}`;


    const iconSpan = document.createElement("span");
    iconSpan.classList.add("down-arrow"); // Use the same class name
    iconSpan.innerHTML = "^"; // Use the caret symbol
    iconSpan.style.transform = "rotate(180deg)"; // Rotate the caret to point downward
    indexCell.appendChild(iconSpan);

    row.appendChild(indexCell);

    const cell = document.createElement("td");
    cell.contentEditable = "true";
    row.appendChild(cell);
    tbody.appendChild(row);
}
// Function to close the popup
function closePopup() {

    const popup = document.getElementById("popup");
    if (popup) {
        popup.remove(); // Remove the popup from the DOM
    }
}


function showPopup(target, options, callback) {

    let popup = document.getElementById("popup-menu");
    if (!popup) {
        popup = document.createElement("div");
        popup.id = "popup-menu";
        popup.classList.add("popup-menu");
        document.body.appendChild(popup);
    }

    popup.innerHTML = "";
    options.forEach(option => {
        const button = document.createElement("button");
        button.textContent = option;
        button.onclick = () => {
            callback(option);
            popup.style.display = "none";
        };
        popup.appendChild(button);
    });


    
    const rect = target.getBoundingClientRect();
    const gapX = 70; // Horizontal gap for better positioning
    const gapY = 70;  // Vertical gap for better positioning

    const table = target.closest('table');
    if (!table) return;

    // Find the correct table container using the unique ID
    const tableContainer = table.closest('.table-content-container');
    if (!tableContainer) return;

    // Get popup dimensions after rendering
    setTimeout(() => {
    const popupWidth = popup.offsetWidth;
    const popupHeight = popup.offsetHeight;


    // **Positioning Adjustments**
    let leftPosition = rect.right - popupWidth + gapX; // Align to right-bottom corner
    let topPosition = rect.bottom + gapY; // Align below the element

    // **Ensure it stays within viewport**
    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;

    // If popup overflows the right side, shift it left
    if (leftPosition + popupWidth > viewportWidth) {
        leftPosition = rect.right - popupWidth - gapX;
    }

    // If popup overflows the bottom, shift it up
    if (topPosition + popupHeight > viewportHeight) {
        topPosition = rect.top - popupHeight - gapY;
    }



    //const topPosition = 347;
    // Set the popup position and override with !important
    popup.style.position = "absolute";
    popup.style.setProperty('top', `${topPosition}px`, 'important');
    popup.style.setProperty('left', `${leftPosition}px`, 'important');

    // Set display properties
    popup.style.display = "block";
    popup.style.boxShadow = "rgba(0, 0, 0, 0.2) 0px 2px 10px";
    popup.style.display = "flex";
    popup.style.flexDirection = "column";
}, 0);
}


document.addEventListener("click", function (event) {
    const popup = document.getElementById("popup-menu");
    if (popup && !popup.contains(event.target) && !event.target.classList.contains("down-arrow")) {
        popup.style.display = "none";
    }
});


function renameColumn(columnIndex, thead, table) {
    debugger;
    const headerCell = table.querySelector(`thead tr th:nth-child(${columnIndex + 1})`); // Select the corresponding header cell
    const editableSpan = headerCell.querySelector(".editable-span");
    editableSpan.setAttribute("contenteditable", "true");
    editableSpan.classList.add("editable");
    editableSpan.focus();
    editableSpan.addEventListener("keydown", (event) => {
        if (event.key === "Enter") {
            event.preventDefault(); // Prevents line break in contenteditable
            editableSpan.removeAttribute("contenteditable");
            editableSpan.classList.remove("editable");
            console.log("New Header Value:", editableSpan.textContent.trim());
        }
    });
}
function insertColumnAt(index, thead, tbody) {
    const columnCount = thead.children[0].children.length;

    const headerCell = document.createElement("th");
    headerCell.classList.add("header-cell");


    const textSpan = document.createElement("span");
    textSpan.innerText = `Column ${columnCount}`; // Editable text
    textSpan.classList.add('editable-span');
    headerCell.appendChild(textSpan);

    const iconSpan = document.createElement("span");
    iconSpan.classList.add("down-arrow");
    iconSpan.innerHTML = "^";

    // Append the icon to the header cell
    headerCell.appendChild(iconSpan);



    thead.children[0].insertBefore(headerCell, thead.children[0].children[index + 1]);

    Array.from(tbody.children).forEach(row => {
        const newCell = document.createElement("td");
        newCell.contentEditable = "true";
        row.insertBefore(newCell, row.children[index + 1]);
    });
}

function deleteColumn(index, thead, tbody, table) {
    debugger;
    const columnName = thead.children[0].children[index].querySelector('.editable-span').textContent.trim();

    let tableName = table.getAttribute("name");
    const columnLabelPrefix = `${tableName}/`;
    // Filter out all labels that match the column name
    jsonStructure.labels = jsonStructure.labels.filter(l =>
        !(l.label.startsWith(columnLabelPrefix) && l.label.endsWith(`/${columnName}`))
    );
    console.log(jsonStructure);
    if (thead.children[0].children.length > 1) {
        thead.children[0].children[index].remove();

        Array.from(tbody.children).forEach(row => {
            row.children[index].remove();
        });
    }

}

function insertRowBelow(index, thead, tbody, table) {
    debugger;
    const row = document.createElement("tr");
    const rowCount = (tbody.children.length - 1) + 1;

    const indexCell = document.createElement("td");
    indexCell.innerHTML = `#${rowCount}`;

    const iconSpan = document.createElement("span");
    iconSpan.classList.add("down-arrow"); // Use the same class name
    iconSpan.innerHTML = "^"; // Use the caret symbol
    iconSpan.style.transform = "rotate(180deg)"; // Rotate the caret to point downward

    indexCell.appendChild(iconSpan);




    row.appendChild(indexCell);

    Array.from(thead.children[0].children).slice(1).forEach(() => {
        const cell = document.createElement("td");
        cell.contentEditable = "true";
        row.appendChild(cell);
    });

    tbody.insertBefore(row, tbody.children[index + 1]);
    try {
        updateRowNumbers(tbody);
    }
    catch {
        closePopup();
    }
    closePopup();
}

function deleteRow(index, tbody, table) {
    debugger;

    let rowLabel = table.getAttribute("name") + "/" + index;
    jsonStructure.labels = jsonStructure.labels.filter(l => l.label.startsWith(rowLabel));
    console.log(jsonStructure);
    if (tbody.children.length > 1) {
        tbody.children[index].remove();
        try {
            updateRowNumbers(tbody);
        }
        catch {
            closePopup();
        }

    }
    closePopup();
}
function updateRowNumbers(tbody) {
    Array.from(tbody.children).forEach((row, i) => {
        const iconSpan = document.createElement("span");
        iconSpan.classList.add("down-arrow"); // Use the same class name
        iconSpan.innerHTML = "^"; // Use the caret symbol
        iconSpan.style.transform = "rotate(180deg)"; //
        row.children[0].textContent(iconSpan);
        row.children[0].innerHTML = `#${i}`;

    });
}



function handleEnter(event) {

    if (event.key === 'Enter') {
        const fieldValue = document.getElementById("fieldInput").value.trim();
        if (fieldValue) {
            // Adding the new field to the JSON
            jsonData.fields.push({
                "fieldKey": fieldValue,
                "fieldType": "string",
                "fieldFormat": "not-specified"
            });
            console.log(jsonData); // Log the updated JSON
            addField(fieldValue);
            closePopup();
        } else {
            document.getElementById("errorMessage").style.display = "block"; // Show error message
        }
    }
}
// Function to close the popup
function closePopup() {

    const popup = document.getElementById("popup");
    if (popup) {
        popup.remove(); // Remove the popup from the DOM
    }
}

function addField(fieldKey) {
    debugger;
    // Create the field container and display elements.
    const fieldContainer = document.createElement('div');
    fieldContainer.className = 'field-container';

    const inputContainer = document.createElement('div');
    inputContainer.className = 'input-container';

    const labelContainer = document.createElement('div');
    labelContainer.className = 'label-conainer';
    // Create label element
    const fieldLabel = document.createElement('label');
    fieldLabel.className = 'field-label';
    fieldLabel.textContent = fieldKey;

    labelsArray.push(fieldLabel);
    console.log("Labels Array" + JSON.stringify(labelsArray, null, 2));

    // Create input element
    const inputField = document.createElement('input');
    inputField.className = 'field-input';
    inputField.type = 'text'; // Adjust type as needed
    inputField.placeholder = 'Enter value...'; // Optional placeholder

    // Associate label with input
    fieldLabel.htmlFor = inputField.id = `input-${fieldKey}`;


    const closeButton = document.createElement('button');
    closeButton.className = 'close-button';
    closeButton.innerHTML = '&times;'; // Close icon ( symbol)
    closeButton.id = `close-${fieldKey}`; // Set unique id for the close button

    // Create settings button
    const button = document.createElement('button');
    button.className = 'settings-button';
    const settingsBtn = document.createElement('i');
    settingsBtn.className = 'fa fa-cog settings-btn';
    button.appendChild(settingsBtn);

    // Append elements




    // Set up field data (JSON will be updated with these values).
    let fieldData = {
        fieldKey: fieldKey,
        fieldType: null,
        fieldFormat: "not-specified",
        subType: null // Add subType to fieldData
    };

    // -------------------------------
    // Create Primary Modal (Field Type Selection)
    const modalPrimary = document.createElement('dialog');
    modalPrimary.className = 'settings-modal';

    const primaryContent = document.createElement('div');
    primaryContent.className = 'modal-content';

    const typeContainer = document.createElement('div');
    typeContainer.className = 'type-container';

    const types = [
        { name: 'Sub Type', value: 'sub-type', hasSubCategory: true },
        { name: 'Rename', value: 'rename', hasSubCategory: false },
        { name: 'Delete', value: 'delete', hasSubCategory: false }
    ];

    types.forEach(type => {
        const typeButton = document.createElement('button');
        typeButton.className = 'type-button';
        //typeButton.textContent = type.name;

        typeButton.style.display = 'flex';
        typeButton.style.alignItems = 'center'; // Align items vertically centered
        typeButton.style.gap = '8px'; // Add some space between the icon and text
        const icon = document.createElement('i'); // Create an <i> element for the icon
        icon.className = `fa-solid ${getIconClass(type.value)}`; // Dynamically set the icon class based on the type

        // Create a text span for the button name
        const buttonText = document.createElement('span');
        buttonText.textContent = type.name;

        // Append the icon and the text to the button
        typeButton.appendChild(icon);
        typeButton.appendChild(buttonText);




        // Create a span for the icon name and arrow for "sub-type"
        if (type.value === 'sub-type') {

            const arrow = document.createElement('span');
            arrow.textContent = ' <-'; // Add the left arrow

            // Append icon name and arrow after the main text

            typeButton.appendChild(arrow);
        } else {
            // For other types, just append the text
            typeButton.appendChild(buttonText);
        }


        typeButton.addEventListener('click', function () {
            fieldData.fieldType = type.value;
            debugger;

            if (type.value === 'sub-type') {
                // Find the correct settings-modal (closest to the clicked button)
                const modalPrimary = this.closest('.settings-modal');
                if (!modalPrimary) return;

                // Find the corresponding subtype-modal (next sibling of the settings-modal)
                const modalSubType = modalPrimary.nextElementSibling;
                if (!modalSubType || !modalSubType.classList.contains('subtype-modal')) return;

                // Show the correct SubType modal
                modalSubType.showModal();



                // Ensure the modal is positioned absolutely
                modalSubType.style.position = "absolute";
                modalSubType.style.transform = "none";
                modalSubType.style.margin = "0";
                modalSubType.style.padding = "10px";
                modalSubType.style.border = "1px solid #ccc";
                modalSubType.style.boxShadow = "0 2px 10px rgba(0, 0, 0, 0.1)";

                // Get bounding rect of the primary modal
                const settingsRect = modalPrimary.getBoundingClientRect();

                // Position the subtype modal exactly to the left of the primary modal
                //const gap = 5; // Adjust this value for fine-tuning


                setTimeout(() => {
                    modalSubType.style.top = `${settingsRect.top + window.scrollY}px`;
                    modalSubType.style.left = `${settingsRect.left + window.scrollX - modalSubType.offsetWidth - 5}px`;

                    console.log("Opened SubType Modal at:", modalSubType.style.left, modalSubType.style.top);
                }, 0);
                //modalSubType.style.left = `${settingsRect.left + window.scrollX - modalSubType.offsetWidth - gap}px`;

                //console.log("Opened SubType Modal at:", modalSubType.style.left);

                // Ensure subtype buttons are stacked properly
                const subtypeContainer = modalSubType.querySelector('.subtype-container');
                if (subtypeContainer) {
                    subtypeContainer.style.display = 'flex';
                    subtypeContainer.style.flexDirection = 'column';
                    subtypeContainer.style.gap = '8px';
                }
            } else {
                // For Rename and Delete, update the JSON and close the primary modal.
                updateJson(fieldData);
                modalPrimary.close();
            }
        });
        typeContainer.appendChild(typeButton);
    });



    function getIconClass(typeValue) {
        switch (typeValue) {
            case 'sub-type':
                return 'fa-bookmark'; // Bookmark icon for Sub Type
            case 'rename':
                return 'fa-pen-to-square'; // Pen icon for Rename
            case 'delete':
                return 'fa-trash'; // Trash icon for Delete
            default:
                return '';
        }
    }
    primaryContent.appendChild(typeContainer);
    modalPrimary.appendChild(primaryContent);
    document.body.appendChild(modalPrimary);

    // -------------------------------
    // Create Secondary Modal (Sub Type Selection)
    const modalSubType = document.createElement('dialog');
    modalSubType.className = 'subtype-modal';

    const subTypeContent = document.createElement('div');
    subTypeContent.className = 'modal-content';

    const subTypeContainer = document.createElement('div');
    subTypeContainer.className = 'subtype-container';

    // Update subTypes to include 'String', 'Number', 'Date', 'Time', 'Integer'
    const subTypes = [
        { name: 'String', value: 'string' },
        { name: 'Integer', value: 'integer' },
        { name: 'Date', value: 'date' }
    ];

    subTypes.forEach(subType => {
        const subTypeButton = document.createElement('button');
        subTypeButton.className = 'subtype-button';
        subTypeButton.textContent = subType.name;


        const buttonText = document.createElement('span');
        buttonText.textContent = subType.name;

        // Create a span for the icon name and arrow for "Date"
        if (subType.value === 'date') {

            const arrow = document.createElement('span');
            arrow.textContent = ' <-'; // Add the left arrow

            // Append icon name and arrow after the main text

            subTypeButton.appendChild(arrow);
        } else {
            // For other types, just append the text
            //subTypeButton.appendChild(buttonText);
        }

        subTypeButton.addEventListener('click', function () {
            fieldData.subType = subType.value; // Update the subType in fieldData
            updateJson(fieldData); // Update the JSON data
            //modalSubType.close(); // Close the sub-type modal
            // If 'Date' is selected, show the date format modal

            if (subType.value === 'date') {
                modalSecondary.showModal(); // Show the modal for date format


                debugger;
                const dateFormatModal = modalSubType.nextElementSibling; // Find the relevant modal

                if (!dateFormatModal || !dateFormatModal.classList.contains('date-format-modal')) {
                    console.error("Date format modal not found!");
                    return;
                }

                // Ensure the date format modal is styled properly
                dateFormatModal.style.position = "absolute";
                dateFormatModal.style.transform = "none";
                dateFormatModal.style.margin = "0";
                dateFormatModal.style.padding = "10px";
                dateFormatModal.style.border = "1px solid #ccc";
                dateFormatModal.style.boxShadow = "0 2px 10px rgba(0, 0, 0, 0.1)";

                // Get the position of modalSubType (the entire sub-type modal)
                const subTypeModalRect = modalSubType.getBoundingClientRect();

                // Calculate the left position for the date format modal
                const dateFormatLeft = subTypeModalRect.left + window.scrollX - dateFormatModal.offsetWidth - 5;

                // Apply the top and left positioning
                dateFormatModal.style.top = `${subTypeModalRect.top + window.scrollY}px`;
                dateFormatModal.style.left = `${dateFormatLeft}px`;

                console.log("Date format modal position - Left:", dateFormatModal.style.left);
                console.log("Date format modal position - Top:", dateFormatModal.style.top);
            }

            // Optionally close the primary modal if needed
            // modalPrimary.close();
        });

        subTypeContainer.appendChild(subTypeButton);
    });



    subTypeContent.appendChild(subTypeContainer);
    modalSubType.appendChild(subTypeContent);
    document.body.appendChild(modalSubType);

    // -------------------------------
    // Create Secondary Modal (Date Format Selection)
    // Create Secondary Modal (Date Format Selection)
    // Create Secondary Modal (Date Format Selection)
    // Create Secondary Modal (Date Format Selection)
    // Create Secondary Modal (Date Format Selection)
    const modalSecondary = document.createElement('dialog');
    modalSecondary.className = 'date-format-modal';

    const secondaryContent = document.createElement('div');
    secondaryContent.className = 'modal-content';

    const formatContainer = document.createElement('div');
    formatContainer.className = 'format-container';
    formatContainer.style.display = 'flex';
    formatContainer.style.flexDirection = 'column'; // Stack buttons vertically
    formatContainer.style.gap = '8px'; // Add spacing

    ['DMY', 'YMD'].forEach(format => {
        const formatButton = document.createElement('button');
        formatButton.className = 'format-button';
        formatButton.textContent = format;
        formatButton.addEventListener('click', function () {
            fieldData.fieldFormat = format.toLowerCase();
            updateJson(fieldData);
            modalSecondary.close();
            modalSubType.close(); // Close subtype modal as well if needed
        });
        formatContainer.appendChild(formatButton);
    });

    secondaryContent.appendChild(formatContainer);
    modalSecondary.appendChild(secondaryContent);
    document.body.appendChild(modalSecondary);

    // Function to position modalSecondary to the left of modalSubType
    // Function to position date-format-modal exactly left of subtype-modal
    // Function to position date-format-modal exactly left of subtype-modal



    secondaryContent.appendChild(formatContainer);
    modalSecondary.appendChild(secondaryContent);
    document.body.appendChild(modalSecondary);

    // -------------------------------
    // JSON Update Helper Function
    function updateJson(data) {
        let existingField = jsonData.fields.find(field => field.fieldKey === fieldKey);
        if (existingField) {
            existingField.fieldType = data.fieldType;
            existingField.fieldFormat = data.fieldFormat;
            existingField.subType = data.subType; // Update the subtype in the JSON
        } else {
            jsonData.fields.push(data);
        }
        console.log(jsonData);
    }


    // -------------------------------
    // Reset modal state on each click so that they appear fresh.
    button.addEventListener('click', function (e) {
        debugger;
        // Reset the fieldData values.
        fieldData.fieldType = null;
        fieldData.fieldFormat = "not-specified";

        // Ensure both modals are closed before opening.
        if (modalPrimary.open) modalPrimary.close();
        if (modalSecondary.open) modalSecondary.close();

        const buttonRect = button.getBoundingClientRect();
        const modalWidth = 130; // Set fixed modal width

        // Calculate left position (shift left if modal is wider)
        let leftPosition = buttonRect.left + window.scrollX;
        if (modalWidth > buttonRect.width) {
            leftPosition = buttonRect.left + window.scrollX - (modalWidth - buttonRect.width);
        }

        // Adjust modal position to appear directly below the button
        modalPrimary.style.position = "absolute";
        modalPrimary.style.transform = "none";  // Remove default centering
        modalPrimary.style.margin = "0";  // Remove default spacing
        modalPrimary.style.padding = "10px";
        modalPrimary.style.border = "1px solid #ccc";
        modalPrimary.style.boxShadow = "0 2px 10px rgba(0, 0, 0, 0.1)";

        // **Set fixed top position to appear below the button**
        modalPrimary.style.top = `${buttonRect.bottom + window.scrollY}px`;
        modalPrimary.style.left = `${leftPosition}px`;
        //modalPrimary.style.width = `${modalWidth}px`;

        const typeContainer = modalPrimary.querySelector('.type-container');
        if (typeContainer) {
            typeContainer.style.display = "flex";
            typeContainer.style.flexDirection = "column";
            typeContainer.style.gap = "8px";  // Adjust for spacing
        }


        modalPrimary.showModal();

        e.stopPropagation();
    });

    function closeModals(event) {
        debugger;
        // Get only the open modals
        const modalPrimary = document.querySelector('.settings-modal[open]');
        const modalSecondary = document.querySelector('.subtype-modal[open]');
        const dateFormatModal = document.querySelector('.date-format-modal[open]');

        // Safely get modal content elements if the modals exist
        const modalContent1 = modalPrimary ? modalPrimary.querySelector('.modal-content') : null;
        const modalContent2 = modalSecondary ? modalSecondary.querySelector('.modal-content') : null;
        const dateFormatContent = dateFormatModal ? dateFormatModal.querySelector('.modal-content') : null;

        // Check if click is inside any modal (if the content exists)
        const isClickInsidePrimary = modalContent1 ? modalContent1.contains(event.target) : false;
        const isClickInsideSecondary = modalContent2 ? modalContent2.contains(event.target) : false;
        const isClickInsideDateFormat = dateFormatContent ? dateFormatContent.contains(event.target) : false;

        // Close settings and subtype modals if click is on the "String" or "Integer" button inside the secondary modal
        if (isClickInsideSecondary && (event.target.textContent === 'String' || event.target.textContent === 'Integer')) {
            if (modalPrimary && modalPrimary.open) {
                modalPrimary.close();
            }
            if (modalSecondary && modalSecondary.open) {
                modalSecondary.close();
            }
        }

        // Close all modals if click is inside the date format modal
        if (isClickInsideDateFormat) {
            if (dateFormatModal && dateFormatModal.open) {
                dateFormatModal.close();
            }
            if (modalSecondary && modalSecondary.open) {
                modalSecondary.close();
            }
            if (modalPrimary && modalPrimary.open) {
                modalPrimary.close();
            }
        }

        // If click is outside of all modals, close any open modal(s)
        if (!isClickInsidePrimary && !isClickInsideSecondary && !isClickInsideDateFormat) {
            if (dateFormatModal && dateFormatModal.open) {
                dateFormatModal.close();
            } else if (modalSecondary && modalSecondary.open) {
                modalSecondary.close();
            } else if (modalPrimary && modalPrimary.open) {
                modalPrimary.close();
            }
        }
    }


    // Attach event listener to close modals when clicking outside
    document.addEventListener("click", closeModals);

    // labelContainer.appendChild(fieldLabel);
    // labelContainer.appendChild(button);
    // inputContainer.appendChild(labelContainer);
    // inputContainer.appendChild(inputField);
    // inputContainer.appendChild(closeButton);
    // fieldContainer.appendChild(inputContainer);
    labelContainer.appendChild(fieldLabel);
    labelContainer.appendChild(button);
    inputContainer.appendChild(inputField);
    inputContainer.appendChild(closeButton);
    fieldContainer.appendChild(labelContainer);
    fieldContainer.appendChild(inputContainer);


    document.getElementById('fields-container').appendChild(fieldContainer);

    closeButton.onclick = () => {
        const inputContainer = closeButton.closest('.input-container');

        // Retrieve the label element and extract its text content (trimmed)
        const labelElement = inputContainer.querySelector('.field-label');
        const labelText = labelElement.textContent.trim();
        const inputField = inputContainer.querySelector('.field-input');
        // Find the index of the label in jsonStructure.labels that matches the label text
        const labelIndex = jsonStructure.labels.findIndex(l => l.label === labelText);

        // If the label exists in the JSON structure, remove it
        if (labelIndex !== -1) {
            jsonStructure.labels.splice(labelIndex, 1);
            console.log(`Removed label: ${labelText}`);
        } else {
            console.log(`Label "${labelText}" not found in JSON structure.`);
        }
        inputField.value = '';
        // (Optional) Log the updated JSON structure for verification
        console.log(JSON.stringify(jsonStructure, null, 2));
    };





    document.querySelectorAll('.field-input').forEach(function (inputBox) {
        inputBox.addEventListener('click', function () {
            debugger;
            let container = inputBox.closest(".input-container");
            const canvas = document.getElementsByClassName("pdf-page")[0];

            // Get its rendered size on the page
            const rect = canvas.getBoundingClientRect();
            const renderedWidth = rect.width;
            const renderedHeight = rect.height;
            // Get the label text
            if (container) {
                let label = container.parentElement.querySelector(".field-label");
                if (label) {
                    console.log("Selected Label:", label.textContent);
                    if (contentArray.length > 0 && boundingBoxArray.length > 0) {

                        const labelName = label.textContent.trim(); // Get label name
                        let existingLabel = jsonStructure.labels.find(l => l.label === labelName);

                        if (!existingLabel) {
                            // Create a new label object if it doesn't exist
                            existingLabel = {
                                label: labelName,
                                value: []
                            };
                            jsonStructure.labels.push(existingLabel);
                        }

                        // Add values to the existing label object
                        contentArray.forEach((text, i) => {
                            const scaledBoundingBox = boundingBoxArray[i].map((value, index) => {
                                if (index % 2 === 0) {
                                    // x-coordinate: multiply by 72 then divide by the rendered width
                                    return value * 72 / renderedWidth;
                                } else {
                                    // y-coordinate: multiply by 72 then divide by the rendered height
                                    return value * 72 / renderedHeight;
                                }
                            });
                            let valueObject = {
                                page: 1, // Keep page as 1
                                text: text, // Use text from contentArray
                                boundingBoxes: scaledBoundingBox // Use boundingBox from boundingBoxArray
                            };
                            existingLabel.value.push(valueObject);
                        });
                        rubberBinding(boundingBoxArray);
                        arrow(inputBox, boundingBoxArray[0]);
                        const inputId = label.getAttribute("for");
                        const inputElement = document.getElementById(inputId);
                        if (inputElement) {
                            // Append the new values to the existing input value
                            inputElement.value = contentArray.join(" ")

                        }


                        // Log the updated JSON structure (for debugging)
                        console.log(JSON.stringify(jsonStructure, null, 2));

                        contentArray.length = 0;
                        boundingBoxArray.length = 0;
                    }
                    else {
                        //Get boundingn box from json
                        const labelName = label.textContent.trim(); // Get label name
                        let boundingBoxArray = jsonStructure.labels.find(l => l.label === labelName).value[0].boundingBoxes;
                        const scaledBoundingBox = boundingBoxArray.map((value, index) => {
                            if (index % 2 === 0) {
                                // x-coordinate: multiply by 72 then divide by the rendered width
                                return value * renderedWidth / 72;
                            } else {
                                // y-coordinate: multiply by 72 then divide by the rendered height
                                return value * renderedHeight / 72;
                            }
                        });
                        //show arrow
                        arrow(inputBox, scaledBoundingBox);
                    }
                }
            }
        });
    });
}

function arrow(inputElement, boundingBox) {
    const canvas = document.getElementsByClassName("pdf-page")[0];

    const inputBoxCoordinates = inputElement.getBoundingClientRect();


    const startingPointOfArrawx = inputBoxCoordinates.left + inputBoxCoordinates.width;
    const startingPointOfArrawY = inputBoxCoordinates.top + (inputBoxCoordinates.height / 2);

    const leftMidX = (boundingBox[0] + boundingBox[6]) / 2;
    const leftMidY = (boundingBox[1] + boundingBox[7]) / 2;

    const canvasRect = canvas.getBoundingClientRect();


    const endingPointOfArrawx = canvasRect.left + (leftMidX * 72);
    const endingPointOfArrawY = canvasRect.top + (leftMidY * 72);

    const midX = startingPointOfArrawx + (endingPointOfArrawx - startingPointOfArrawx) / 2;
    const svg = document.querySelector("#platform_id_vG7OoRnx svg");
    const path = svg.querySelector("path");
    let arrowGroup = svg.querySelector("g");

    if (!arrowGroup) {
        arrowGroup = document.createElementNS("http://www.w3.org/2000/svg", "g");
        arrowGroup.setAttribute("fill", "rgba(0, 80, 138, 1)");
        arrowGroup.setAttribute("pointer-events", "auto");
        arrowGroup.setAttribute("opacity", "1");
        svg.appendChild(arrowGroup); // Append group to SVG

        // Create the arrowhead shape
        const arrowPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
        arrowPath.setAttribute("d", "M 0 0 L 1 0.5 L 0 1 L 0.25 0.5 z");
        arrowGroup.appendChild(arrowPath); // Append arrow to group

        // Create the arrow fade-in animation
        const animateOpacity = document.createElementNS("http://www.w3.org/2000/svg", "animate");
        animateOpacity.setAttribute("dur", "0.4");
        animateOpacity.setAttribute("attributeName", "opacity");
        animateOpacity.setAttribute("from", "0");
        animateOpacity.setAttribute("to", "1");
        animateOpacity.setAttribute("begin", "indefinite");
        animateOpacity.setAttribute("repeatCount", "0");
        animateOpacity.setAttribute("fill", "freeze");
        arrowGroup.appendChild(animateOpacity); // Add fade-in animation to arrow group
        svg.appendChild(arrowGroup);
    }
    // Update the path data for the line
    const pathData = `M ${startingPointOfArrawx - 10} ${startingPointOfArrawY - 65} H ${midX} V ${endingPointOfArrawY - 62} H ${endingPointOfArrawx - 26}`;
    path.setAttribute("d", pathData);

    // Position the arrow at the endpoint
    arrowGroup.setAttribute("transform", `translate(${endingPointOfArrawx - 28}, ${endingPointOfArrawY - 68}) scale(15)`);
    function removeArrow(event) {
        debugger;
        if (!inputElement.contains(event.target)) { // Check if click is outside inputElement
            path.setAttribute("d", ""); // Clear the path
            arrowGroup.remove(); // Remove the arrow group
            document.removeEventListener("click", removeArrow); // Remove event listener after execution
        }
    }

    // Attach the event listener to document
    document.addEventListener("click", removeArrow);
}

function createSVGContainer() {
    // Get the container element by ID
    const container = document.getElementById("platform_id_vG7OoRnx");

    // Create SVG element
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "100%");
    svg.setAttribute("height", "100%");
    svg.setAttribute("overflow", "visible");
    svg.style.position = "absolute";
    container.appendChild(svg); // Append the SVG to your container

    // Create the animated dashed line path
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("stroke", "rgba(0, 80, 138, 1)");
    path.setAttribute("stroke-dasharray", "5 2.5");
    path.setAttribute("stroke-width", "2.5");
    path.setAttribute("fill", "transparent");
    path.setAttribute("pointer-events", "visibleStroke");

    // Add animation for the dashed effect
    const animateDash = document.createElementNS("http://www.w3.org/2000/svg", "animate");
    animateDash.setAttribute("attributeName", "stroke-dashoffset");
    animateDash.setAttribute("values", "7.5;0");
    animateDash.setAttribute("dur", "1s");
    animateDash.setAttribute("repeatCount", "indefinite");
    path.appendChild(animateDash);
    svg.appendChild(path); // Append path to SVG

    // Create the arrowhead group
    const arrowGroup = document.createElementNS("http://www.w3.org/2000/svg", "g");
    arrowGroup.setAttribute("fill", "rgba(0, 80, 138, 1)");
    arrowGroup.setAttribute("pointer-events", "auto");
    arrowGroup.setAttribute("opacity", "1");
    svg.appendChild(arrowGroup); // Append group to SVG

    // Create the arrowhead shape
    const arrowPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
    arrowPath.setAttribute("d", "M 0 0 L 1 0.5 L 0 1 L 0.25 0.5 z");
    arrowGroup.appendChild(arrowPath); // Append arrow to group

    // Create the arrow fade-in animation
    const animateOpacity = document.createElementNS("http://www.w3.org/2000/svg", "animate");
    animateOpacity.setAttribute("dur", "0.4");
    animateOpacity.setAttribute("attributeName", "opacity");
    animateOpacity.setAttribute("from", "0");
    animateOpacity.setAttribute("to", "1");
    animateOpacity.setAttribute("begin", "indefinite");
    animateOpacity.setAttribute("repeatCount", "0");
    animateOpacity.setAttribute("fill", "freeze");
    arrowGroup.appendChild(animateOpacity); // Add fade-in animation to arrow group
}